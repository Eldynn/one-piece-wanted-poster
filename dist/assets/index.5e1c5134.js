var Te=Object.defineProperty;var de=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,We=Object.prototype.propertyIsEnumerable;var ne=(c,t,e)=>t in c?Te(c,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[t]=e,X=(c,t)=>{for(var e in t||(t={}))Ce.call(t,e)&&ne(c,e,t[e]);if(de)for(var e of de(t))We.call(t,e)&&ne(c,e,t[e]);return c};var Y=(c,t,e)=>(ne(c,typeof t!="symbol"?t+"":t,e),e),oe=(c,t,e)=>{if(!t.has(c))throw TypeError("Cannot "+e)};var i=(c,t,e)=>(oe(c,t,"read from private field"),e?e.call(c):t.get(c)),o=(c,t,e)=>{if(t.has(c))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(c):t.set(c,e)},h=(c,t,e,s)=>(oe(c,t,"write to private field"),s?s.call(c,e):t.set(c,e),e),ue=(c,t,e,s)=>({set _(n){h(c,t,n,e)},get _(){return i(c,t,s)}}),d=(c,t,e)=>(oe(c,t,"access private method"),e);import{v as Me,n as Be}from"./vendor.098c5d43.js";const je=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}};je();function Oe(c={}){const{immediate:t=!1,onNeedRefresh:e,onOfflineReady:s,onRegistered:n,onRegisterError:a}=c;let r,l;const f=async(g=!0)=>{g&&(r==null||r.addEventListener("controlling",m=>{m.isUpdate&&window.location.reload()})),l&&l.waiting&&await Be(l.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){r=new Me("/service-worker.js",{scope:"/",type:"classic"}),r.addEventListener("activated",g=>{g.isUpdate||s==null||s()});{const g=()=>{e==null||e()};r.addEventListener("waiting",g),r.addEventListener("externalwaiting",g)}r.register({immediate:t}).then(g=>{l=g,n==null||n(g)}).catch(g=>{a==null||a(g)})}return f}Oe();var Ne=`:host{display:inline-flex;position:relative;cursor:pointer;width:4.25rem;height:5rem;background-color:transparent;transition:.5s;justify-content:center}:host(:hover){filter:contrast(110%) brightness(110%) drop-shadow(0 1px 5px black)}.img{position:absolute;max-width:100%;max-height:100%}.icon{position:absolute;font-size:1.5rem;color:#513721;display:flex;justify-content:center;align-items:center;top:21%;width:82%;height:44%;box-sizing:border-box}.text{font-size:.72rem;position:absolute;display:flex;justify-content:center;align-items:center;font-family:Gelasio,Noto Sans TC,sans-serif;color:#513721;bottom:12%;width:85%;height:20%;white-space:nowrap;overflow:hidden;font-weight:900;text-align:justify;box-sizing:border-box}
`,De="assets/wanted.c2a6dd7a.png";const Ue=["icon","text","font-size","loading"],Le=document.createElement("template");Le.innerHTML=`
  <img class="img" src="${De}"/>
  <div class="icon">
    <i class="fa"></i>
  </div>
  <span class="text"></span>
`;var $,L,tt;class He extends HTMLElement{constructor(){super();o(this,$,"");o(this,L,void 0);o(this,tt,void 0);const t=this.attachShadow({mode:"open"}),e=document.createElement("style");e.textContent=Ne,t.append(e,Le.content.cloneNode(!0)),h(this,L,t.querySelector("i.fa")),h(this,tt,t.querySelector("span.text"));const s=document.querySelector('link[href*="font-awesome"]');s&&t.appendChild(s.cloneNode())}static get observedAttributes(){return Ue}attributeChangedCallback(t,e,s){switch(t){case"icon":h(this,$,s),i(this,L).classList.add(s);break;case"text":i(this,tt).textContent=s;break;case"font-size":i(this,tt).style.fontSize=s;break;case"loading":s!==null?(this.style.pointerEvents="none",i(this,L).classList.remove(i(this,$)),i(this,L).classList.add("fa-circle-notch","fa-spin")):(this.style.pointerEvents="auto",i(this,L).classList.remove("fa-circle-notch","fa-spin"),i(this,L).classList.add(i(this,$)));break}}}$=new WeakMap,L=new WeakMap,tt=new WeakMap;customElements.define("wanted-button",He);async function bt(c){return new Promise((t,e)=>{const s=new Image;s.onload=()=>t(s),s.onerror=e,s.src=c})}function re(c,t,e,s){const n=c/e,a=t/s;return Math.min(a,n)}function ge(c,t,e,s,n,a,r=0){const l=r/2,f=e-l,g=s-l,m=e+n+l,A=s+a+l,I=c>=f&&c<=m,H=t>=g&&t<=A;return I&&H}function Xe(c,t,e,s,n,a,r=0){const l=r/2,f=e-l,g=s-l,m=e+n+l,A=s+a+l,I=e+l,H=s+l,wt=e+n-l,pt=s+a-l;return{left:c>=f&&c<=I,right:c>=wt&&c<=m,top:t>=g&&t<=H,bottom:t>=pt&&t<=A}}function Se(c,t){const{actualBoundingBoxAscent:e,actualBoundingBoxDescent:s}=c.measureText(t);return e+s}function Ye(c,t){let e=document.createElement("a");e.setAttribute("href",c),e.setAttribute("download",t),e.style.display="none",document.body.appendChild(e),e.click(),e.remove()}var Fe=`:host{display:block;height:100%;width:100%}.container{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;box-sizing:border-box}
`,Ke="assets/one-piece-wanted.d3bd87d0.png";const Ot={url:Ke,width:772,height:1154,avatarPosition:{x:74,y:252,width:638,height:484},namePosition:{x:88,y:826,width:585,height:114},bountyPosition:{x:88,y:953,width:586,height:85},bountyFontSize:60,boundaryOffset:{left:10,right:10,top:10,bottom:10},bellySignSize:{width:60,height:84}};class se{constructor(t){Y(this,"x",0);Y(this,"y",0);Y(this,"width",0);Y(this,"height",0);Y(this,"ctx");this.ctx=t}scale(t){this.x=this.x*t,this.y=this.y*t,this.width=this.width*t,this.height=this.height*t}}var ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAALaSURBVDhPNZTdjuw0EIRtt+04mdlfrUCAEELA4Qpxgc79eQ/e/wV2d5LYjt18zi5WZGXi7urq6vLYf7/9bc+1bdt6K61rCKEZKy44H27vaylliZO1ptba9RCx3rspxXmenedVxDhtegSfRIK10lo7WnHSl6s8v1zIjDHOy8QiXgjycYrJsWop+5pNt2p8b+44OkUomPMGCJmtV2M7OTH6y+WS0tK7ybk64g4K9d5Va9nVNKjM85RSdM5yUur+8vJ8/jSjZghsJN9um/z545MPATLELfPVextioBEYqVEwnRVRc7QDNgo376mzrbmU6lSV1CnSQ0wXJ0GNbcdRD9jTSPf0+/r+miF1Ltje3hF3L6XJP19+hgwVjDHWjzTYBh/ExyAJCWOYrtfp8fHxer2DEKA5Z+2KcI4hkWbUMZvbWz+qz7vW2jwnphhdxeXRptiu9J9bq8uS7u7nEO1Q+7OstYjBSEbgicjOKTul9n0njKMz/lBtRDl0ynuliW3LxJHMMM55jHXKM8BVOfzEYv8Ic2RycD4KJeYxbOOGeTyGMc6o9c632speTDcRdiGkaVrmWX77/okJ8xjLGEmTD0lOtbGpQYxWwe1Kc3boxGTxpLXqmuqWczljh3AA/S/Bx06f2DlIZKLRB+xzWdIUvdHmhl+ndHKJIOBK9tGftbzgP+CMQScmEwa6oVyjLHLJX7/+RAGqoRx1h1vPHFBY7eijkdJPrLrvay2VfFKIlx9wwDSndM37IbThZN3Wz4IK5/D2thof8lEHkrEueCseW1iJ8vt39+Jgc/RWMCh60DW3x/uAjNb6Wvrr+9u63hg1lwzNPmwFWfn6xy/4p9Pn0Aer4wR33hTcBxB8KcKX8elMG5rSAk2554fL0/1yt8TLcMSYMOriAd4/hCCb+xXFzzEt08KN4347tUQ4bjLPEJRJnDnsgDNqsMf12Tfko2CcZEpE8e8k85IeHh7+Azww6jnizFt7AAAAAElFTkSuQmCC",et,Dt,it,st,Ut;class fe extends se{constructor(){super(...arguments);o(this,et,"");o(this,Dt,1);o(this,it,0);o(this,st,null);o(this,Ut,1.31)}async init(t){try{const e=await bt(ke);h(this,st,this.ctx.createPattern(e,"repeat"))}catch(e){throw console.error(e),new Error("Failed to init Name.")}this.setPosition(t)}setPosition(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,h(this,it,this.height*i(this,Ut))}set text(t){const e=new Array(i(this,Dt)).join(" ")+" ";h(this,et,Array.from(t).join(e))}render(){this.ctx.save(),this.ctx.textAlign="center",this.ctx.textBaseline="top",this.ctx.fillStyle=i(this,st)?i(this,st):"none",this.ctx.font=`900 ${i(this,it)}px 'Gelasio', 'Noto Sans TC', sans-serif`;const t=Se(this.ctx,i(this,et)),e=this.height/t,s=(t-this.height)/2;this.ctx.font=`900 ${Math.floor(i(this,it)*e)}px 'Gelasio', 'Noto Sans TC', sans-serif`,this.ctx.fillText(i(this,et),this.x+this.width/2,this.y+s,this.width),this.ctx.restore()}}et=new WeakMap,Dt=new WeakMap,it=new WeakMap,st=new WeakMap,Ut=new WeakMap;var qe="assets/paper.16062456.png";const me={x:0,y:0,width:0,height:0};var F,W,p,nt,S,yt,ot,xt,we;class be extends se{constructor(){super(...arguments);o(this,xt);o(this,F,void 0);Y(this,"filter","grayscale(35%) sepia(40%) saturate(80%) contrast(105%)");o(this,W,new Map);o(this,p,null);o(this,nt,null);o(this,S,X({},me));o(this,yt,X({},me));o(this,ot,{left:0,right:0,top:0,bottom:0})}async init(t){h(this,F,t);try{const e=await bt(qe);h(this,nt,this.ctx.createPattern(e,"repeat"))}catch(e){throw console.error(e),new Error("Failed to create fill pattern.")}d(this,xt,we).call(this)}async loadImage(t){var e;if(!!t)try{h(this,p,await bt(t)),d(this,xt,we).call(this),(e=i(this,W).get("imageloaded"))==null||e.forEach(s=>s())}catch(s){throw console.error(s),new Error("Failed to load avatar image.")}}scale(t){super.scale(t),this.updateRenderPosition()}setWantedImageInfo(t){h(this,F,t),h(this,ot,X({},t.boundaryOffset)),h(this,S,X({},t.avatarPosition))}updateRenderPosition(){if(!i(this,p))return;const t=re(this.width,this.height,i(this,p).width,i(this,p).height),e=i(this,p).width*t,s=i(this,p).height*t,n=this.x+(this.width-e)/2,a=this.y+(this.height-s)/2;h(this,yt,{x:n,y:a,width:e,height:s})}on(t,e){var s;i(this,W).has(t)||i(this,W).set(t,[]),(s=i(this,W).get(t))==null||s.push(e)}off(t,e){const s=i(this,W).get(t);if(!s)return;const n=s.findIndex(a=>a===e);s.splice(n,1)}render(){if(this.ctx.save(),this.ctx.fillStyle=i(this,nt)?i(this,nt):"none",this.ctx.fillRect(i(this,S).x,i(this,S).y,i(this,S).width,i(this,S).height),!i(this,p)){this.ctx.restore();return}const{x:t,y:e,width:s,height:n}=i(this,yt);this.ctx.filter=this.filter,this.ctx.drawImage(i(this,p),t,e,s,n);const{left:a,right:r,top:l,bottom:f}=i(this,ot);t<=a&&this.ctx.clearRect(0,e,a,n),e<=l&&this.ctx.clearRect(t,0,s,l),t+s>this.ctx.canvas.width-r&&this.ctx.clearRect(this.ctx.canvas.width-r,e,r,n),e+n>this.ctx.canvas.height-f&&this.ctx.clearRect(t,this.ctx.canvas.height-f,s,f),this.ctx.canvas.width,this.ctx.restore()}}F=new WeakMap,W=new WeakMap,p=new WeakMap,nt=new WeakMap,S=new WeakMap,yt=new WeakMap,ot=new WeakMap,xt=new WeakSet,we=function(){if(!i(this,F))return;const{avatarPosition:t,boundaryOffset:e}=i(this,F);this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,h(this,ot,X({},e)),h(this,S,{x:this.x,y:this.y,width:this.width,height:this.height}),this.updateRenderPosition()};var Ge="assets/belly.5c6b32bd.png",M,Ht,vt,ht,At,at,Xt,rt;class pe extends se{constructor(t){super(t);o(this,M,"");o(this,Ht,1);o(this,vt,0);o(this,ht,null);o(this,At,void 0);o(this,at,null);o(this,Xt,10);o(this,rt,null);h(this,At,new Intl.NumberFormat)}async init(t){try{h(this,at,await bt(Ge));const e=await bt(ke);h(this,ht,this.ctx.createPattern(e,"repeat"))}catch(e){throw console.error(e),new Error("Failed to init bounty.")}this.setPosition(t)}setPosition(t){const{bountyPosition:e,bountyFontSize:s,bellySignSize:n}=t;this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,h(this,vt,s),h(this,rt,X({},n))}set text(t){const e=new Array(i(this,Ht)).join(" ")+" ",s=Number.parseInt(t);if(Number.isNaN(s)){h(this,M,Array.from(t).join(e));return}const n=i(this,At).format(s)+"-";h(this,M,Array.from(n).join(e))}render(){if(!i(this,at)||!i(this,rt))return;const{width:t,height:e}=i(this,rt);this.ctx.save(),this.ctx.textAlign="center",this.ctx.textBaseline="top",this.ctx.fillStyle=i(this,ht)?i(this,ht):"none",this.ctx.font=`900 ${i(this,vt)}px 'Itim', sans-serif`;const s=this.x+this.width/2,n=t+i(this,Xt),a=Se(this.ctx,i(this,M)),r=(this.height-a)/2,l=s+n/2,f=this.y+r,g=this.width-n;this.ctx.fillText(i(this,M),l,f,g);const m=Math.min(this.ctx.measureText(i(this,M)).width,g),A=s-n/2-m/2;this.ctx.drawImage(i(this,at),A,this.y,t,e),this.ctx.restore()}}M=new WeakMap,Ht=new WeakMap,vt=new WeakMap,ht=new WeakMap,At=new WeakMap,at=new WeakMap,Xt=new WeakMap,rt=new WeakMap;var k,B,Et,y,j,K,q,P,ct,Yt,Je;class ye{constructor(t){o(this,Yt);o(this,k,void 0);o(this,B,void 0);o(this,Et,1);o(this,y,0);o(this,j,0);o(this,K,0);o(this,q,0);o(this,P,null);o(this,ct,null);h(this,k,t),h(this,B,t.canvas)}get scale(){return i(this,Et)}async loadImage(t){try{const e=await bt(t.url);h(this,P,e),h(this,K,e.width),h(this,q,e.height),h(this,ct,t)}catch(e){throw console.error(e),new Error("Failed to load wanted image.")}}setSize({width:t,height:e,padding:s}){if(!i(this,P))throw new Error("Failed to set size: wanted image is null");h(this,K,t!=null?t:i(this,K)),h(this,q,e!=null?e:i(this,q)),h(this,j,s!=null?s:i(this,j));const n=i(this,P).width+i(this,j)*2,a=i(this,P).height+i(this,j)*2,r=re(i(this,K),i(this,q),n,a);return h(this,Et,r),h(this,y,i(this,j)*r),i(this,B).width=n*r,i(this,B).height=a*r,{wantedImageInfo:d(this,Yt,Je).call(this,r,i(this,y)),scale:r,scaledPadding:i(this,y)}}render(){!i(this,P)||(i(this,k).save(),i(this,k).shadowColor="rgba(0, 0, 0, 1)",i(this,k).shadowBlur=i(this,y),i(this,k).drawImage(i(this,P),i(this,y),i(this,y),i(this,B).width-i(this,y)*2,i(this,B).height-i(this,y)*2),i(this,k).restore())}}k=new WeakMap,B=new WeakMap,Et=new WeakMap,y=new WeakMap,j=new WeakMap,K=new WeakMap,q=new WeakMap,P=new WeakMap,ct=new WeakMap,Yt=new WeakSet,Je=function(t,e){if(!i(this,ct))throw new Error("Failed to calculate wanted image info: WantedImageInfo object is null");const{url:s,width:n,height:a,avatarPosition:r,namePosition:l,bountyPosition:f,bountyFontSize:g,boundaryOffset:m,bellySignSize:A}=i(this,ct),I=H=>{const{x:wt,y:pt,width:V,height:Bt}=H;return{x:wt*t+e,y:pt*t+e,width:V*t,height:Bt*t}};return{url:s,width:n,height:a,avatarPosition:I(r),namePosition:I(l),bountyPosition:I(f),bountyFontSize:g*t,boundaryOffset:{left:m.left*t+e,right:m.right*t+e,top:m.top*t+e,bottom:m.bottom*t+e},bellySignSize:{width:A.width*t,height:A.height*t}}};var u,w,O,E,G,J,x,Q,It,Lt,Ft,_e,Kt,Ze,qt,Ve,Gt,$e,Jt,ti,Qt,ei,_t,ii,Zt,si,Vt,ni,St,xe,kt,ve,$t,oi,te,hi;class Qe extends se{constructor(t,e){super(t);o(this,Ft);o(this,Kt);o(this,qt);o(this,Gt);o(this,Jt);o(this,Qt);o(this,_t);o(this,Zt);o(this,Vt);o(this,St);o(this,kt);o(this,$t);o(this,te);o(this,u,void 0);o(this,w,!1);o(this,O,!1);o(this,E,!1);o(this,G,4);o(this,J,null);o(this,x,new Map);o(this,Q,0);o(this,It,0);o(this,Lt,0);h(this,u,e),e.on("imageloaded",()=>this.reset()),t.canvas.addEventListener("mousedown",d(this,Ft,_e).bind(this)),t.canvas.addEventListener("mouseup",d(this,Kt,Ze).bind(this)),t.canvas.addEventListener("mousemove",d(this,qt,Ve).bind(this)),t.canvas.addEventListener("mouseout",d(this,Gt,$e).bind(this)),t.canvas.addEventListener("wheel",d(this,Jt,ti).bind(this)),t.canvas.addEventListener("touchstart",d(this,Qt,ei).bind(this)),t.canvas.addEventListener("touchend",d(this,_t,ii).bind(this)),t.canvas.addEventListener("touchcancel",d(this,Zt,si).bind(this)),t.canvas.addEventListener("touchmove",d(this,Vt,ni).bind(this))}reset(){this.x=i(this,u).x,this.y=i(this,u).y,this.width=i(this,u).width,this.height=i(this,u).height,h(this,w,!1),h(this,O,!1),h(this,E,!1)}render(){!i(this,w)&&!i(this,E)||(this.ctx.save(),ue(this,Q)._++,i(this,Q)>16&&h(this,Q,0),this.ctx.lineDashOffset=-i(this,Q),this.ctx.fillStyle="rgba(255,255,255,0.5)",this.ctx.strokeStyle="red",this.ctx.lineWidth=i(this,G),this.ctx.setLineDash([10,5]),this.ctx.fillRect(this.x,this.y,this.width,this.height),this.ctx.strokeRect(this.x,this.y,this.width,this.height),this.ctx.restore())}}u=new WeakMap,w=new WeakMap,O=new WeakMap,E=new WeakMap,G=new WeakMap,J=new WeakMap,x=new WeakMap,Q=new WeakMap,It=new WeakMap,Lt=new WeakMap,Ft=new WeakSet,_e=function(){h(this,O,!0)},Kt=new WeakSet,Ze=function(){h(this,O,!1),h(this,E,!1)},qt=new WeakSet,Ve=function(t){const{left:e,top:s}=this.ctx.canvas.getBoundingClientRect(),n=t.clientX-e,a=t.clientY-s;if(i(this,O)){const r=t.clientX-i(this,It),l=t.clientY-i(this,Lt);d(this,te,hi).call(this,r,l)}i(this,E)||d(this,$t,oi).call(this,n,a),ge(n,a,this.x,this.y,this.width,this.height,i(this,G))?h(this,w,!0):h(this,w,!1),h(this,It,t.clientX),h(this,Lt,t.clientY)},Gt=new WeakSet,$e=function(){h(this,O,!1),h(this,E,!1),h(this,w,!1)},Jt=new WeakSet,ti=function(t){t.preventDefault();const e=t.deltaY>0?.9:1.1;d(this,kt,ve).call(this,e)},Qt=new WeakSet,ei=function(t){t.preventDefault();const e=t.changedTouches;for(let r=0;r<e.length;r++)i(this,x).set(e[r].identifier,e[r]);const{left:s,top:n}=this.ctx.canvas.getBoundingClientRect();let a=!1;for(let r of i(this,x).values()){const l=r.clientX-s,f=r.clientY-n;if(ge(l,f,this.x,this.y,this.width,this.height,i(this,G))){a=!0;break}}h(this,w,a)},_t=new WeakSet,ii=function(t){const e=t.changedTouches;for(let s=0;s<e.length;s++)i(this,x).delete(e[s].identifier)},Zt=new WeakSet,si=function(t){const e=t.changedTouches;for(let s=0;s<e.length;s++)i(this,x).delete(e[s].identifier)},Vt=new WeakSet,ni=function(t){const e=t.changedTouches;if(e.length===1&&i(this,w)){const s=e[0],{clientX:n,clientY:a}=s,r=i(this,x).get(s.identifier);if(r){const l=n-r.clientX,f=a-r.clientY;this.x+=l,this.y+=f,i(this,u).x+=l,i(this,u).y+=f,i(this,u).updateRenderPosition()}}if(e.length===2&&i(this,w)){let s=i(this,x).get(e[0].identifier),n=i(this,x).get(e[1].identifier);if(s&&n){let a=d(this,St,xe).call(this,e[0],e[1]),r=d(this,St,xe).call(this,s,n),l=a>r?1.04:.96;d(this,kt,ve).call(this,l)}}for(let s=0;s<e.length;s++)i(this,x).set(e[s].identifier,e[s])},St=new WeakSet,xe=function(t,e){const s=Math.abs(t.clientX-e.clientX),n=Math.abs(t.clientY-e.clientY);return Math.pow(s,2)+Math.pow(n,2)},kt=new WeakSet,ve=function(t){const e=this.width*t-this.width,s=this.height*t-this.height;this.x=this.x-e/2,this.width=this.width+e,this.y=this.y-s/2,this.height=this.height+s,i(this,u).x=this.x,i(this,u).y=this.y,i(this,u).width=this.width,i(this,u).height=this.height,i(this,u).updateRenderPosition()},$t=new WeakSet,oi=function(t,e){const s=Xe(t,e,this.x,this.y,this.width,this.height,i(this,G));s.left||s.right?(this.ctx.canvas.style.cursor="ew-resize",h(this,J,s.left?"left":"right")):s.top||s.bottom?(this.ctx.canvas.style.cursor="ns-resize",h(this,J,s.top?"top":"bottom")):i(this,w)?this.ctx.canvas.style.cursor="move":this.ctx.canvas.style.cursor="default"},te=new WeakSet,hi=function(t,e){switch(this.ctx.canvas.style.cursor){case"move":this.x+=t,this.y+=e,i(this,u).x+=t,i(this,u).y+=e,i(this,u).updateRenderPosition();break;case"ew-resize":{if(h(this,E,!0),i(this,J)==="right"){const s=Math.max(this.width+t,1);this.width=s,i(this,u).width=s}else{const s=this.x+t;if(s>=this.x+this.width)break;const n=this.width-t;this.x=s,i(this,u).x=s,this.width=n,i(this,u).width=n}i(this,u).updateRenderPosition();break}case"ns-resize":{if(h(this,E,!0),i(this,J)==="bottom"){const s=Math.max(this.height+e,1);this.height=s,i(this,u).height=s}else{const s=this.y+e;if(s>=this.y+this.height)break;const n=this.height-e;this.y=s,i(this,u).y=s,this.height=n,i(this,u).height=n}i(this,u).updateRenderPosition()}}};const ai=["name","bounty","avatar-url","filter","padding"];var N,D,Pt,b,lt,R,z,T,C,dt,Rt,ut,he,zt,Ae,Tt,Ee;class ri extends HTMLElement{constructor(){super();o(this,ut);o(this,zt);o(this,Tt);o(this,N,void 0);o(this,D,void 0);o(this,Pt,void 0);o(this,b,void 0);o(this,lt,void 0);o(this,R,void 0);o(this,z,void 0);o(this,T,void 0);o(this,C,void 0);o(this,dt,void 0);o(this,Rt,void 0);h(this,C,"init");const t=this.attachShadow({mode:"open"}),e=document.createElement("canvas"),s=document.createElement("div");s.className="container",s.appendChild(e);const n=document.createElement("style");n.textContent=Fe,t.append(n,s);const a=e.getContext("2d");h(this,N,s),h(this,D,e),h(this,Pt,a),h(this,T,new ye(a)),h(this,b,new be(a)),h(this,R,new fe(a)),h(this,z,new pe(a)),h(this,lt,new Qe(a,i(this,b))),h(this,dt,new ResizeObserver(()=>{clearTimeout(i(this,Rt)),h(this,Rt,window.setTimeout(()=>d(this,zt,Ae).call(this),200))})),i(this,dt).observe(s)}async export(){var Bt,ce;const t=document.createElement("canvas");t.style.display="none",i(this,N).appendChild(t);const e=t.getContext("2d"),s=d(this,ut,he).call(this),n=new ye(e),a=new be(e),r=new fe(e),l=new pe(e);await n.loadImage(Ot);const f=Ot.width+s*2,g=Ot.height+s*2,{wantedImageInfo:m}=n.setSize({width:f,height:g,padding:s});await a.init(m),await r.init(m.namePosition),await l.init(m),await a.loadImage(this.getAttribute("avatar-url")),r.text=(Bt=this.getAttribute("name"))!=null?Bt:"",l.text=(ce=this.getAttribute("bounty"))!=null?ce:"";const{x:A,y:I,width:H,height:wt,filter:pt}=i(this,b),V=i(this,T).scale;a.x=A/V,a.y=I/V,a.width=H/V,a.height=wt/V,a.filter=pt,a.updateRenderPosition(),a.render(),n.render(),l.render(),r.render();try{const jt=await new Promise(Re=>{t.toBlob(ze=>Re(ze),"image/png",1)});if(!jt)throw new Error("blob is null");const le=URL.createObjectURL(jt);Ye(le,"wanted-poster.png"),URL.revokeObjectURL(le),i(this,N).removeChild(t)}catch(jt){console.error(jt),this.dispatchEvent(new CustomEvent("ExportError",{bubbles:!0}))}}static get observedAttributes(){return ai}async connectedCallback(){var n,a;console.log("[connected]"),await new Promise(r=>{setTimeout(()=>r(""))}),h(this,C,"loading");const t=d(this,ut,he).call(this),e=i(this,N).getBoundingClientRect();try{await i(this,T).loadImage(Ot);const{wantedImageInfo:r}=i(this,T).setSize({width:e.width,height:e.height,padding:t});await i(this,b).init(r),await i(this,R).init(r.namePosition),await i(this,z).init(r),await i(this,b).loadImage(this.getAttribute("avatar-url"))}catch(r){h(this,C,"error"),console.error("Failed to init wanted poster.",r);return}i(this,R).text=(n=this.getAttribute("name"))!=null?n:"",i(this,z).text=(a=this.getAttribute("bounty"))!=null?a:"";const s=this.getAttribute("filter");s&&(i(this,b).filter=s),h(this,C,"success"),d(this,Tt,Ee).call(this),this.dispatchEvent(new CustomEvent("WantedPosterLoaded",{bubbles:!0}))}disconnectedCallback(){console.log("[disconnected]"),i(this,dt).disconnect()}adoptedCallback(){console.log("[adopted]")}async attributeChangedCallback(t,e,s){if(i(this,C)==="success")switch(t){case"name":i(this,R).text=s;break;case"bounty":i(this,z).text=s;break;case"avatar-url":{await i(this,b).loadImage(s);break}case"filter":{i(this,b).filter=s;break}case"padding":{d(this,zt,Ae).call(this);break}}}}N=new WeakMap,D=new WeakMap,Pt=new WeakMap,b=new WeakMap,lt=new WeakMap,R=new WeakMap,z=new WeakMap,T=new WeakMap,C=new WeakMap,dt=new WeakMap,Rt=new WeakMap,ut=new WeakSet,he=function(){const t=this.getAttribute("padding");if(!t)return 0;const e=Number.parseInt(t);return Number.isNaN(e)?0:e},zt=new WeakSet,Ae=function(){if(i(this,C)!=="success")return;const t=d(this,ut,he).call(this),e=i(this,N).getBoundingClientRect(),s=re(e.width,e.height,i(this,D).width,i(this,D).height),{wantedImageInfo:n}=i(this,T).setSize({width:e.width,height:e.height,padding:t});i(this,R).setPosition(n.namePosition),i(this,z).setPosition(n),i(this,b).setWantedImageInfo(n),i(this,b).scale(s),i(this,lt).scale(s)},Tt=new WeakSet,Ee=function(){i(this,Pt).clearRect(0,0,i(this,D).width,i(this,D).height),i(this,b).render(),i(this,T).render(),i(this,z).render(),i(this,R).render(),i(this,lt).render(),requestAnimationFrame(d(this,Tt,Ee).bind(this))};customElements.define("wanted-poster",ri);var ci=`:host{display:block;width:100%;height:100%;background-image:url(./images/wood-panel.jpg);background-blend-mode:multiply;background-size:cover;background-position:center;padding:1rem;box-sizing:border-box;transition:background-color .2s}:host(.warcriminal){background-image:url(./images/wood-panel.jpg),url(./images/blood-stains-0.png)}:host(.dragin){background-color:silver}#uploadInput{display:none}.blood-overlay{position:absolute;width:100%;height:100%;top:0;left:0;opacity:.8;display:none;background-image:url(./images/blood-stains-1.png);background-size:cover;background-position:center;mix-blend-mode:multiply;animation-name:fade-in;animation-duration:4s}.blood-overlay--visible{display:block}.loading-overlay{position:absolute;width:100%;height:100%;top:0;left:0;display:flex;align-items:center;justify-content:center;background-image:radial-gradient(#e1e4e7,#a5aab0)}.loading-overlay__luffy{max-width:50vw;max-height:40vh;animation-name:logo-blink;animation-duration:2s;animation-iteration-count:infinite;animation-timing-function:linear;filter:contrast(80%) brightness(85%) drop-shadow(0 1px 3px gray)}.blood-hand{position:absolute;cursor:pointer;right:1rem;bottom:1rem;width:5rem;height:5rem;border:0;padding:0;background-color:transparent;background-size:contain;background-repeat:no-repeat;background-position:center;transition:.5s;background-image:url(./images/blood-hand.png);filter:contrast(80%) brightness(60%) drop-shadow(0 0 5px gray);mix-blend-mode:multiply}.blood-hand:hover{filter:contrast(100%) brightness(100%) drop-shadow(0 0 15px #770707)}.blood-hand--enabled{animation-name:blood-shadow;animation-duration:4s;animation-iteration-count:infinite;animation-timing-function:linear}.button{position:absolute;bottom:1rem}.button--upload{left:1rem}.button--download{left:6rem}@keyframes blood-shadow{25%{filter:contrast(100%) brightness(100%) drop-shadow(0 0 2rem rgb(134,31,52));transform:scale3d(.96,.96,.5)}50%{filter:contrast(120%) brightness(120%) drop-shadow(0 0 1.5rem crimson);transform:scaleZ(.9)}75%{filter:contrast(110%) brightness(110%) drop-shadow(0 0 2.5rem rgb(255,64,102));transform:scale3d(1.04,1.04,1.5)}}@keyframes logo-blink{50%{filter:contrast(120%) brightness(110%) drop-shadow(0 5px 3px gray)}}@keyframes fade-in{0%{opacity:0}to{opacity:.8}}
`;const Pe=document.createElement("template");Pe.innerHTML=`
  <input id="uploadInput" type="file" >
  <slot name="poster"></slot>
  <div class="blood-overlay"></div>

  <slot></slot>

  <wanted-button id="uploadButton" class="button button--upload" icon="fa-upload" text="UPLOAD"></wanted-button>
  <wanted-button id="downloadButton" class="button button--download" icon="fa-download" text="DOWNLOAD" font-size="0.5rem"></wanted-button>
  <button id="bloodhandButton" class="blood-hand"></button>

  <div class="loading-overlay">
    <img class="loading-overlay__luffy" src="./images/luffy.png"/>
  </div>
`;const Nt="#warcriminal",li={name:"PUTLER",padding:"10",bounty:"????????????","avatar-url":"./images/war-criminal.png"};var gt,U,Ct,_,Z,Wt,v,ft,ee,ui,ie,gi,Mt,Ie,mt,ae;class di extends HTMLElement{constructor(){super();o(this,ee);o(this,ie);o(this,Mt);o(this,mt);o(this,gt,void 0);o(this,U,void 0);o(this,Ct,void 0);o(this,_,void 0);o(this,Z,void 0);o(this,Wt,0);o(this,v,void 0);o(this,ft,void 0);const t=this.attachShadow({mode:"open"});h(this,v,t);const e=document.createElement("style");e.textContent=ci,t.append(e,Pe.content.cloneNode(!0)),t.addEventListener("WantedPosterLoaded",()=>{d(this,ee,ui).call(this)});const s=i(this,v).querySelector("slot[name=poster]");h(this,gt,s==null?void 0:s.assignedNodes()[0]),h(this,U,i(this,v).querySelector("#uploadInput")),h(this,Ct,i(this,v).querySelector("#uploadButton")),h(this,_,i(this,v).querySelector("#downloadButton")),h(this,Z,i(this,v).querySelector("#bloodhandButton")),h(this,ft,d(this,ie,gi).bind(this)),window.addEventListener("hashchange",i(this,ft))}connectedCallback(){h(this,Wt,new Date().getTime()),location.hash===Nt&&d(this,Mt,Ie).call(this,!0),this.addEventListener("dragover",t=>{t.preventDefault()}),this.addEventListener("dragenter",()=>{this.classList.add("dragin")}),this.addEventListener("dragleave",()=>{this.classList.remove("dragin")}),this.addEventListener("drop",t=>{var n;t.preventDefault(),this.classList.remove("dragin");const e=(n=t.dataTransfer)==null?void 0:n.files[0];if(!e||!e.type.startsWith("image"))return;const s=URL.createObjectURL(e);d(this,mt,ae).call(this,{"avatar-url":s})}),i(this,U).addEventListener("change",()=>{const t=i(this,U).files?i(this,U).files[0]:null;if(!t||!t.type.startsWith("image"))return;const e=URL.createObjectURL(t);d(this,mt,ae).call(this,{"avatar-url":e})}),i(this,Ct).addEventListener("click",()=>{i(this,U).click()}),i(this,_).addEventListener("click",async()=>{i(this,_).setAttribute("loading","true"),await i(this,gt).export(),i(this,_).removeAttribute("loading")}),i(this,Z).addEventListener("click",()=>{const t=location.hash===Nt;location.hash=t?"":Nt})}disconnectedCallback(){window.removeEventListener("hashchange",i(this,ft))}}gt=new WeakMap,U=new WeakMap,Ct=new WeakMap,_=new WeakMap,Z=new WeakMap,Wt=new WeakMap,v=new WeakMap,ft=new WeakMap,ee=new WeakSet,ui=function(){const t=i(this,v).querySelector(".loading-overlay");let e=1e3,s=setInterval(()=>{new Date().getTime()-i(this,Wt)<e||(clearTimeout(s),t.style.transition="opacity 1s",t.style.opacity="0",setTimeout(()=>{t.remove()},1e3))},200)},ie=new WeakSet,gi=function(){d(this,Mt,Ie).call(this,location.hash===Nt)},Mt=new WeakSet,Ie=function(t){const e=i(this,v).querySelector(".blood-overlay");if(!!e){if(!t){this.classList.remove("warcriminal"),e.classList.remove("blood-overlay--visible"),i(this,Z).classList.remove("blood-hand--enabled");return}this.classList.add("warcriminal"),e.classList.add("blood-overlay--visible"),i(this,Z).classList.add("blood-hand--enabled"),d(this,mt,ae).call(this,li)}},mt=new WeakSet,ae=function(t){var s;const e=Object.keys(t);for(let n of e){const a=(s=t[n])!=null?s:"";i(this,gt).setAttribute(n,a)}};customElements.define("app-container",di);
