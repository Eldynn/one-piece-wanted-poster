var Ni=Object.defineProperty;var Oi=(r,s,t)=>s in r?Ni(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t;var ut=(r,s,t)=>(Oi(r,typeof s!="symbol"?s+"":s,t),t),Oe=(r,s,t)=>{if(!s.has(r))throw TypeError("Cannot "+t)};var e=(r,s,t)=>(Oe(r,s,"read from private field"),t?t.call(r):s.get(r)),a=(r,s,t)=>{if(s.has(r))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(r):s.set(r,t)},h=(r,s,t,i)=>(Oe(r,s,"write to private field"),i?i.call(r,t):s.set(r,t),t),oi=(r,s,t,i)=>({set _(n){h(r,s,n,t)},get _(){return e(r,s,i)}}),p=(r,s,t)=>(Oe(r,s,"access private method"),t);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();try{self["workbox:window:6.5.3"]&&_()}catch{}function He(r,s){return new Promise(function(t){var i=new MessageChannel;i.port1.onmessage=function(n){t(n.data)},r.postMessage(s,[i.port2])})}function Ui(r,s){for(var t=0;t<s.length;t++){var i=s[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function ai(r,s){(s==null||s>r.length)&&(s=r.length);for(var t=0,i=new Array(s);t<s;t++)i[t]=r[t];return i}function qi(r,s){var t;if(typeof Symbol>"u"||r[Symbol.iterator]==null){if(Array.isArray(r)||(t=function(n,o){if(n){if(typeof n=="string")return ai(n,o);var l=Object.prototype.toString.call(n).slice(8,-1);return l==="Object"&&n.constructor&&(l=n.constructor.name),l==="Map"||l==="Set"?Array.from(n):l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l)?ai(n,o):void 0}}(r))||s&&r&&typeof r.length=="number"){t&&(r=t);var i=0;return function(){return i>=r.length?{done:!0}:{done:!1,value:r[i++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}return(t=r[Symbol.iterator]()).next.bind(t)}try{self["workbox:core:6.5.3"]&&_()}catch{}var Ue=function(){var r=this;this.promise=new Promise(function(s,t){r.resolve=s,r.reject=t})};function qe(r,s){var t=location.href;return new URL(r,t).href===new URL(s,t).href}var Xt=function(r,s){this.type=r,Object.assign(this,s)};function ve(r,s,t){return t?s?s(r):r:(r&&r.then||(r=Promise.resolve(r)),s?r.then(s):r)}function Hi(){}var Di={type:"SKIP_WAITING"};function hi(r,s){if(!s)return r&&r.then?r.then(Hi):Promise.resolve()}var Xi=function(r){var s,t;function i(d,g){var c,u;return g===void 0&&(g={}),(c=r.call(this)||this).nn={},c.tn=0,c.rn=new Ue,c.en=new Ue,c.on=new Ue,c.un=0,c.an=new Set,c.cn=function(){var f=c.fn,m=f.installing;c.tn>0||!qe(m.scriptURL,c.sn.toString())||performance.now()>c.un+6e4?(c.vn=m,f.removeEventListener("updatefound",c.cn)):(c.hn=m,c.an.add(m),c.rn.resolve(m)),++c.tn,m.addEventListener("statechange",c.ln)},c.ln=function(f){var m=c.fn,y=f.target,L=y.state,M=y===c.vn,dt={sw:y,isExternal:M,originalEvent:f};!M&&c.mn&&(dt.isUpdate=!0),c.dispatchEvent(new Xt(L,dt)),L==="installed"?c.wn=self.setTimeout(function(){L==="installed"&&m.waiting===y&&c.dispatchEvent(new Xt("waiting",dt))},200):L==="activating"&&(clearTimeout(c.wn),M||c.en.resolve(y))},c.dn=function(f){var m=c.hn,y=m!==navigator.serviceWorker.controller;c.dispatchEvent(new Xt("controlling",{isExternal:y,originalEvent:f,sw:m,isUpdate:c.mn})),y||c.on.resolve(m)},c.gn=(u=function(f){var m=f.data,y=f.ports,L=f.source;return ve(c.getSW(),function(){c.an.has(L)&&c.dispatchEvent(new Xt("message",{data:m,originalEvent:f,ports:y,sw:L}))})},function(){for(var f=[],m=0;m<arguments.length;m++)f[m]=arguments[m];try{return Promise.resolve(u.apply(this,f))}catch(y){return Promise.reject(y)}}),c.sn=d,c.nn=g,navigator.serviceWorker.addEventListener("message",c.gn),c}t=r,(s=i).prototype=Object.create(t.prototype),s.prototype.constructor=s,s.__proto__=t;var n,o,l=i.prototype;return l.register=function(d){var g=(d===void 0?{}:d).immediate,c=g!==void 0&&g;try{var u=this;return function(f,m){var y=f();return y&&y.then?y.then(m):m(y)}(function(){if(!c&&document.readyState!=="complete")return hi(new Promise(function(f){return window.addEventListener("load",f)}))},function(){return u.mn=Boolean(navigator.serviceWorker.controller),u.yn=u.pn(),ve(u.bn(),function(f){u.fn=f,u.yn&&(u.hn=u.yn,u.en.resolve(u.yn),u.on.resolve(u.yn),u.yn.addEventListener("statechange",u.ln,{once:!0}));var m=u.fn.waiting;return m&&qe(m.scriptURL,u.sn.toString())&&(u.hn=m,Promise.resolve().then(function(){u.dispatchEvent(new Xt("waiting",{sw:m,wasWaitingBeforeRegister:!0}))}).then(function(){})),u.hn&&(u.rn.resolve(u.hn),u.an.add(u.hn)),u.fn.addEventListener("updatefound",u.cn),navigator.serviceWorker.addEventListener("controllerchange",u.dn),u.fn})})}catch(f){return Promise.reject(f)}},l.update=function(){try{return this.fn?hi(this.fn.update()):void 0}catch(d){return Promise.reject(d)}},l.getSW=function(){return this.hn!==void 0?Promise.resolve(this.hn):this.rn.promise},l.messageSW=function(d){try{return ve(this.getSW(),function(g){return He(g,d)})}catch(g){return Promise.reject(g)}},l.messageSkipWaiting=function(){this.fn&&this.fn.waiting&&He(this.fn.waiting,Di)},l.pn=function(){var d=navigator.serviceWorker.controller;return d&&qe(d.scriptURL,this.sn.toString())?d:void 0},l.bn=function(){try{var d=this;return function(g,c){try{var u=g()}catch(f){return c(f)}return u&&u.then?u.then(void 0,c):u}(function(){return ve(navigator.serviceWorker.register(d.sn,d.nn),function(g){return d.un=performance.now(),g})},function(g){throw g})}catch(g){return Promise.reject(g)}},n=i,(o=[{key:"active",get:function(){return this.en.promise}},{key:"controlling",get:function(){return this.on.promise}}])&&Ui(n.prototype,o),i}(function(){function r(){this.Pn=new Map}var s=r.prototype;return s.addEventListener=function(t,i){this.Sn(t).add(i)},s.removeEventListener=function(t,i){this.Sn(t).delete(i)},s.dispatchEvent=function(t){t.target=this;for(var i,n=qi(this.Sn(t.type));!(i=n()).done;)(0,i.value)(t)},s.Sn=function(t){return this.Pn.has(t)||this.Pn.set(t,new Set),this.Pn.get(t)},r}());function Yi(r={}){const{immediate:s=!1,onNeedRefresh:t,onOfflineReady:i,onRegistered:n,onRegisterError:o}=r;let l,d;const g=async(c=!0)=>{c&&(l==null||l.addEventListener("controlling",u=>{u.isUpdate&&window.location.reload()})),d&&d.waiting&&await He(d.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){l=new Xi("./service-worker.js",{scope:"./",type:"classic"}),l.addEventListener("activated",c=>{c.isUpdate||i==null||i()});{const c=()=>{t==null||t()};l.addEventListener("waiting",c),l.addEventListener("externalwaiting",c)}l.register({immediate:s}).then(c=>{d=c,n==null||n(c)}).catch(c=>{o==null||o(c)})}return g}Yi();const Fi=`:host{position:relative;width:317px;height:298px;display:flex;justify-content:center;align-items:center}.bottom-img{display:block;max-width:100%;max-height:100%;object-fit:contain;aspect-ratio:317/298}.top-img{position:absolute;left:0;right:0;top:0;bottom:0;margin:auto;max-width:100%;max-height:100%;animation-name:flicker;animation-duration:4s;animation-iteration-count:infinite;animation-timing-function:linear;filter:brightness(1.8);-webkit-mask-image:linear-gradient(90deg,rgba(0,0,0,0) 35%,rgba(255,255,255,1) 50%,rgba(0,0,0,0) 65%);mask-image:linear-gradient(90deg,rgba(0,0,0,0) 35%,rgba(255,255,255,1) 50%,rgba(0,0,0,0) 65%);-webkit-mask-size:300% 100%;mask-size:300% 100%;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat}@keyframes flicker{0%{-webkit-mask-position:150% 0%;mask-position:150% 0%}30%{-webkit-mask-position:-150% 0%;mask-position:-150% 0%}to{-webkit-mask-position:-150% 0%;mask-position:-150% 0%}}
`,$i=`<img class="bottom-img" src="./images/luffy.png" alt="luffy avatar" />\r
<img class="top-img" src="./images/luffy.png" alt="luffy avatar" />`,Ki="luffy-logo",mi=document.createElement("template");mi.innerHTML=$i;class Gi extends HTMLElement{constructor(){super();const s=this.attachShadow({mode:"open"}),t=document.createElement("style");t.textContent=Fi,s.append(t,mi.content.cloneNode(!0))}}customElements.define(Ki,Gi);const Ji=`:host{outline:none;display:inline-flex;position:relative;cursor:pointer;width:4.25rem;height:5rem;background-color:transparent;transition:.5s;justify-content:center;filter:contrast(100%) brightness(100%) drop-shadow(1px 1px 1px rgba(0,0,0,.5)) drop-shadow(-1px -1px 1px rgba(0,0,0,.5))}:host(:hover){filter:contrast(110%) brightness(110%) drop-shadow(1px 4px 4px rgba(0,0,0,.5)) drop-shadow(-1px 0px 4px rgba(0,0,0,.5))}.img{position:absolute;max-width:100%;max-height:100%}.icon{position:absolute;font-size:1.5rem;color:#513721;display:flex;justify-content:center;align-items:center;top:21%;width:82%;height:44%;box-sizing:border-box}.text{font-size:.9rem;position:absolute;display:flex;justify-content:center;align-items:center;font-family:Scheherazade New,Noto Sans TC,sans-serif;color:#513721;bottom:12%;width:85%;height:20%;white-space:nowrap;overflow:hidden;font-weight:900;text-align:justify;box-sizing:border-box}
`,Qi=`<img class="img" alt="button image" />\r
<div class="icon">\r
  <i class="fa"></i>\r
</div>\r
<span class="text">\r
  <slot></slot>\r
</span>`,Zi=""+new URL("wanted.c2a6dd7a.png",import.meta.url).href,Vi="wanted-button",tn=["icon","font-size","loading"],fi=document.createElement("template");fi.innerHTML=Qi;var Et,j,$t;class en extends HTMLElement{constructor(){var o;super();a(this,Et,"");a(this,j,void 0);a(this,$t,void 0);const t=this.attachShadow({mode:"open"}),i=document.createElement("style");i.textContent=Ji,t.append(i,fi.content.cloneNode(!0)),(o=t.querySelector("img"))==null||o.setAttribute("src",Zi),h(this,j,t.querySelector("i.fa")),h(this,$t,t.querySelector("span.text"));const n=document.querySelector('link[href*="font-awesome"]');n&&t.appendChild(n.cloneNode())}static get observedAttributes(){return tn}attributeChangedCallback(t,i,n){switch(t){case"icon":h(this,Et,n),e(this,j).classList.add(n);break;case"font-size":e(this,$t).style.fontSize=n;break;case"loading":n!==null?(this.style.pointerEvents="none",e(this,j).classList.remove(e(this,Et)),e(this,j).classList.add("fa-circle-notch","fa-spin")):(this.style.pointerEvents="auto",e(this,j).classList.remove("fa-circle-notch","fa-spin"),e(this,j).classList.add(e(this,Et)));break}}}Et=new WeakMap,j=new WeakMap,$t=new WeakMap;customElements.define(Vi,en);async function Dt(r){return new Promise((s,t)=>{const i=new Image;i.onload=()=>s(i),i.onerror=t,i.src=r})}function ti(r,s,t,i){const n=r/t,o=s/i;return Math.min(o,n)}function li(r,s,t,i,n,o,l=0){const d=l/2,g=t-d,c=i-d,u=t+n+d,f=i+o+d,m=r>=g&&r<=u,y=s>=c&&s<=f;return m&&y}function nn(r,s,t,i,n,o,l=0){const d=l/2,g=t-d,c=i-d,u=t+n+d,f=i+o+d,m=t+d,y=i+d,L=t+n-d,M=i+o-d;return{left:r>=g&&r<=m,right:r>=L&&r<=u,top:s>=c&&s<=y,bottom:s>=M&&s<=f}}function bi(r,s){const{actualBoundingBoxAscent:t,actualBoundingBoxDescent:i}=r.measureText(s);return t+i}function sn(r,s){let t=document.createElement("a");t.setAttribute("href",r),t.setAttribute("download",s),t.style.display="none",document.body.appendChild(t),t.click(),t.remove()}function De(r,s){let t="";for(let i=0;i<s;i++)t+=" ";return Array.from(r).join(t)}const rn=`:host{display:block;height:100%;width:100%;touch-action:none}.container{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;box-sizing:border-box}
`,on=""+new URL("one-piece-wanted.d3bd87d0.png",import.meta.url).href,ye={url:on,width:772,height:1154,avatarPosition:{x:74,y:252,width:638,height:484},namePosition:{x:88,y:826,width:585,height:114},bountyPosition:{x:88,y:958,width:586,height:85},bountyFontSize:70,boundaryOffset:{left:10,right:10,top:10,bottom:10},bellySignSize:{width:60,height:84}},wi={shadow:10,name:"PUTLER",bounty:"War Criminal",nameSpacing:0,bountySpacing:1,avatarUrl:"./images/war-criminal.png"};class Ne{constructor(s){ut(this,"x",0);ut(this,"y",0);ut(this,"width",0);ut(this,"height",0);ut(this,"ctx");this.ctx=s}scale(s){this.x=this.x*s,this.y=this.y*s,this.width=this.width*s,this.height=this.height*s}}const vi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAALaSURBVDhPNZTdjuw0EIRtt+04mdlfrUCAEELA4Qpxgc79eQ/e/wV2d5LYjt18zi5WZGXi7urq6vLYf7/9bc+1bdt6K61rCKEZKy44H27vaylliZO1ptba9RCx3rspxXmenedVxDhtegSfRIK10lo7WnHSl6s8v1zIjDHOy8QiXgjycYrJsWop+5pNt2p8b+44OkUomPMGCJmtV2M7OTH6y+WS0tK7ybk64g4K9d5Va9nVNKjM85RSdM5yUur+8vJ8/jSjZghsJN9um/z545MPATLELfPVextioBEYqVEwnRVRc7QDNgo376mzrbmU6lSV1CnSQ0wXJ0GNbcdRD9jTSPf0+/r+miF1Ltje3hF3L6XJP19+hgwVjDHWjzTYBh/ExyAJCWOYrtfp8fHxer2DEKA5Z+2KcI4hkWbUMZvbWz+qz7vW2jwnphhdxeXRptiu9J9bq8uS7u7nEO1Q+7OstYjBSEbgicjOKTul9n0njKMz/lBtRDl0ynuliW3LxJHMMM55jHXKM8BVOfzEYv8Ic2RycD4KJeYxbOOGeTyGMc6o9c632speTDcRdiGkaVrmWX77/okJ8xjLGEmTD0lOtbGpQYxWwe1Kc3boxGTxpLXqmuqWczljh3AA/S/Bx06f2DlIZKLRB+xzWdIUvdHmhl+ndHKJIOBK9tGftbzgP+CMQScmEwa6oVyjLHLJX7/+RAGqoRx1h1vPHFBY7eijkdJPrLrvay2VfFKIlx9wwDSndM37IbThZN3Wz4IK5/D2thof8lEHkrEueCseW1iJ8vt39+Jgc/RWMCh60DW3x/uAjNb6Wvrr+9u63hg1lwzNPmwFWfn6xy/4p9Pn0Aer4wR33hTcBxB8KcKX8elMG5rSAk2554fL0/1yt8TLcMSYMOriAd4/hCCb+xXFzzEt08KN4347tUQ4bjLPEJRJnDnsgDNqsMf12Tfko2CcZEpE8e8k85IeHh7+Azww6jnizFt7AAAAAElFTkSuQmCC";var Kt,Lt,Gt,It,At,ke,Jt,Xe;class ci extends Ne{constructor(){super(...arguments);a(this,Jt);a(this,Kt,"");a(this,Lt,"");a(this,Gt,0);a(this,It,0);a(this,At,null);a(this,ke,1.6)}async init(t){try{const i=await Dt(vi);h(this,At,this.ctx.createPattern(i,"repeat"))}catch(i){throw console.error(i),new Error("Failed to init Name.")}this.setPosition(t)}setPosition(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,h(this,It,this.height*e(this,ke))}set text(t){h(this,Kt,t),p(this,Jt,Xe).call(this)}set spacing(t){h(this,Gt,t),p(this,Jt,Xe).call(this)}render(){this.ctx.save(),this.ctx.textAlign="center",this.ctx.textBaseline="top",this.ctx.fillStyle=e(this,At)?e(this,At):"none",this.ctx.font=`700 ${e(this,It)}px 'Scheherazade New', 'Noto Sans TC', serif`;const t=bi(this.ctx,e(this,Lt)),i=this.height/t,n=(t-this.height)/2;this.ctx.font=`700 ${Math.floor(e(this,It)*i)}px 'Scheherazade New', 'Noto Sans TC', serif`,this.ctx.fillText(e(this,Lt),this.x+this.width/2,this.y+n,this.width),this.ctx.restore()}}Kt=new WeakMap,Lt=new WeakMap,Gt=new WeakMap,It=new WeakMap,At=new WeakMap,ke=new WeakMap,Jt=new WeakSet,Xe=function(){h(this,Lt,De(e(this,Kt),e(this,Gt)))};const an=""+new URL("paper.6a3dae0b.png",import.meta.url).href,di={x:0,y:0,width:0,height:0};var gt,F,R,Pt,N,Qt,Rt,Zt,Ye;class ui extends Ne{constructor(){super(...arguments);a(this,Zt);a(this,gt,void 0);ut(this,"filter","grayscale(35%) sepia(40%) saturate(80%) contrast(105%)");a(this,F,new Map);a(this,R,null);a(this,Pt,null);a(this,N,{...di});a(this,Qt,{...di});a(this,Rt,{left:0,right:0,top:0,bottom:0})}async init(t){h(this,gt,t);try{const i=await Dt(an);h(this,Pt,this.ctx.createPattern(i,"repeat"))}catch(i){throw console.error(i),new Error("Failed to create fill pattern.")}p(this,Zt,Ye).call(this)}async loadImage(t){var i;if(!!t)try{h(this,R,await Dt(t)),p(this,Zt,Ye).call(this),(i=e(this,F).get("imageloaded"))==null||i.forEach(n=>n())}catch(n){throw console.error(n),new Error("Failed to load avatar image.")}}scale(t){super.scale(t),this.updateRenderPosition()}setWantedImageInfo(t){h(this,gt,t),h(this,Rt,{...t.boundaryOffset}),h(this,N,{...t.avatarPosition})}updateRenderPosition(){if(!e(this,R))return;const t=ti(this.width,this.height,e(this,R).width,e(this,R).height),i=e(this,R).width*t,n=e(this,R).height*t,o=this.x+(this.width-i)/2,l=this.y+(this.height-n)/2;h(this,Qt,{x:o,y:l,width:i,height:n})}on(t,i){var n;e(this,F).has(t)||e(this,F).set(t,[]),(n=e(this,F).get(t))==null||n.push(i)}off(t,i){const n=e(this,F).get(t);if(!n)return;const o=n.findIndex(l=>l===i);n.splice(o,1)}render(){if(this.ctx.save(),this.ctx.fillStyle=e(this,Pt)?e(this,Pt):"none",this.ctx.fillRect(e(this,N).x,e(this,N).y,e(this,N).width,e(this,N).height),!e(this,R)){this.ctx.restore();return}const{x:t,y:i,width:n,height:o}=e(this,Qt);this.ctx.filter=this.filter,this.ctx.drawImage(e(this,R),t,i,n,o);const{left:l,right:d,top:g,bottom:c}=e(this,Rt);t<=l&&this.ctx.clearRect(0,i,l,o),i<=g&&this.ctx.clearRect(t,0,n,g),t+n>this.ctx.canvas.width-d&&this.ctx.clearRect(this.ctx.canvas.width-d,i,d,o),i+o>this.ctx.canvas.height-c&&this.ctx.clearRect(t,this.ctx.canvas.height-c,n,c),this.ctx.canvas.width,this.ctx.restore()}}gt=new WeakMap,F=new WeakMap,R=new WeakMap,Pt=new WeakMap,N=new WeakMap,Qt=new WeakMap,Rt=new WeakMap,Zt=new WeakSet,Ye=function(){if(!e(this,gt))return;const{avatarPosition:t,boundaryOffset:i}=e(this,gt);this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,h(this,Rt,{...i}),h(this,N,{x:this.x,y:this.y,width:this.width,height:this.height}),this.updateRenderPosition()};const hn=""+new URL("belly.5c6b32bd.png",import.meta.url).href;var zt,$,O,Tt,_t,Ct,Vt,Wt,Ee,Bt,te,Fe;class gi extends Ne{constructor(t){super(t);a(this,te);a(this,zt,"");a(this,$,"");a(this,O,!0);a(this,Tt,0);a(this,_t,0);a(this,Ct,null);a(this,Vt,void 0);a(this,Wt,null);a(this,Ee,10);a(this,Bt,null);h(this,Vt,new Intl.NumberFormat)}async init(t){try{h(this,Wt,await Dt(hn));const i=await Dt(vi);h(this,Ct,this.ctx.createPattern(i,"repeat"))}catch(i){throw console.error(i),new Error("Failed to init bounty.")}this.setPosition(t)}setPosition(t){const{bountyPosition:i,bountyFontSize:n,bellySignSize:o}=t;this.x=i.x,this.y=i.y,this.width=i.width,this.height=i.height,h(this,_t,n),h(this,Bt,{...o})}set text(t){h(this,zt,t),p(this,te,Fe).call(this)}set spacing(t){h(this,Tt,t),p(this,te,Fe).call(this)}render(){if(!e(this,Wt)||!e(this,Bt))return;const{width:t,height:i}=e(this,Bt);this.ctx.save(),this.ctx.textAlign="center",this.ctx.textBaseline="top",this.ctx.fillStyle=e(this,Ct)?e(this,Ct):"none",this.ctx.font=e(this,O)?`700 ${e(this,_t)*.75}px 'Averia Sans Libre'`:`900 ${e(this,_t)}px 'Scheherazade New', 'Noto Sans TC', serif`;const n=this.x+this.width/2,o=e(this,O)?t+e(this,Ee):0,l=bi(this.ctx,e(this,$));let d=(this.height-l)/2;e(this,O)&&(d*=.75);const g=n+o/2,c=this.y+d,u=this.width-o;if(this.ctx.fillText(e(this,$),g,c,u),e(this,O)){const f=Math.min(this.ctx.measureText(e(this,$)).width,u),m=n-o/2-f/2;this.ctx.drawImage(e(this,Wt),m,this.y,t,i)}this.ctx.restore()}}zt=new WeakMap,$=new WeakMap,O=new WeakMap,Tt=new WeakMap,_t=new WeakMap,Ct=new WeakMap,Vt=new WeakMap,Wt=new WeakMap,Ee=new WeakMap,Bt=new WeakMap,te=new WeakSet,Fe=function(){const t=Number.parseInt(e(this,zt));if(Number.isNaN(t)){h(this,O,!1),h(this,$,De(e(this,zt),e(this,Tt)));return}h(this,O,!0);const i=e(this,Vt).format(t)+"-";h(this,$,De(i,e(this,Tt)))};var U,K,ee,z,G,pt,mt,q,Mt,Le,yi;class pi{constructor(s){a(this,Le);a(this,U,void 0);a(this,K,void 0);a(this,ee,1);a(this,z,0);a(this,G,0);a(this,pt,0);a(this,mt,0);a(this,q,null);a(this,Mt,null);h(this,U,s),h(this,K,s.canvas)}get scale(){return e(this,ee)}async loadImage(s){try{const t=await Dt(s.url);h(this,q,t),h(this,pt,t.width),h(this,mt,t.height),h(this,Mt,s)}catch(t){throw console.error(t),new Error("Failed to load wanted image.")}}setSize({width:s,height:t,shadowSize:i}){if(!e(this,q))throw new Error("Failed to set size: wanted image is null");h(this,pt,s!=null?s:e(this,pt)),h(this,mt,t!=null?t:e(this,mt)),h(this,G,i!=null?i:e(this,G));const n=e(this,q).width+e(this,G)*2,o=e(this,q).height+e(this,G)*2,l=ti(e(this,pt),e(this,mt),n,o);return h(this,ee,l),h(this,z,e(this,G)*l),e(this,K).width=n*l,e(this,K).height=o*l,{wantedImageInfo:p(this,Le,yi).call(this,l,e(this,z)),scale:l,scaledShadowSize:e(this,z)}}render(){!e(this,q)||(e(this,U).save(),e(this,U).shadowColor="rgba(0, 0, 0, 1)",e(this,U).shadowBlur=e(this,z),e(this,U).drawImage(e(this,q),e(this,z),e(this,z),e(this,K).width-e(this,z)*2,e(this,K).height-e(this,z)*2),e(this,U).restore())}}U=new WeakMap,K=new WeakMap,ee=new WeakMap,z=new WeakMap,G=new WeakMap,pt=new WeakMap,mt=new WeakMap,q=new WeakMap,Mt=new WeakMap,Le=new WeakSet,yi=function(s,t){if(!e(this,Mt))throw new Error("Failed to calculate wanted image info: WantedImageInfo object is null");const{url:i,width:n,height:o,avatarPosition:l,namePosition:d,bountyPosition:g,bountyFontSize:c,boundaryOffset:u,bellySignSize:f}=e(this,Mt),m=y=>{const{x:L,y:M,width:dt,height:kt}=y;return{x:L*s+t,y:M*s+t,width:dt*s,height:kt*s}};return{url:i,width:n,height:o,avatarPosition:m(l),namePosition:m(d),bountyPosition:m(g),bountyFontSize:c*s,boundaryOffset:{left:u.left*s+t,right:u.right*s+t,top:u.top*s+t,bottom:u.bottom*s+t},bellySignSize:{width:f.width*s,height:f.height*s}}};var w,ft,I,J,W,bt,wt,P,vt,ie,ne,Ie,xi,Ae,Si,Pe,ki,Re,Ei,ze,Li,Te,Ii,_e,Ai,Ce,Pi,se,$e,re,Ke,oe,Ge,We,Ri,Be,zi;class ln extends Ne{constructor(t,i){super(t);a(this,Ie);a(this,Ae);a(this,Pe);a(this,Re);a(this,ze);a(this,Te);a(this,_e);a(this,Ce);a(this,se);a(this,re);a(this,oe);a(this,We);a(this,Be);a(this,w,void 0);a(this,ft,!1);a(this,I,!1);a(this,J,!1);a(this,W,!1);a(this,bt,4);a(this,wt,null);a(this,P,new Map);a(this,vt,0);a(this,ie,0);a(this,ne,0);h(this,w,i),i.on("imageloaded",()=>this.reset()),t.canvas.addEventListener("mouseout",p(this,Ae,Si).bind(this),{passive:!0}),t.canvas.addEventListener("wheel",p(this,Ie,xi).bind(this),{passive:!0}),t.canvas.addEventListener("pointerdown",p(this,Re,Ei).bind(this),{passive:!0}),t.canvas.addEventListener("pointerup",p(this,ze,Li).bind(this),{passive:!0}),t.canvas.addEventListener("pointercancel",p(this,Te,Ii).bind(this),{passive:!0}),t.canvas.addEventListener("pointermove",p(this,_e,Ai).bind(this),{passive:!0}),t.canvas.addEventListener("pointerout",p(this,Ce,Pi).bind(this),{passive:!0})}set highlight(t){h(this,ft,t)}reset(){this.x=e(this,w).x,this.y=e(this,w).y,this.width=e(this,w).width,this.height=e(this,w).height,h(this,I,!1),h(this,J,!1),h(this,W,!1)}render(){!e(this,I)&&!e(this,W)&&!e(this,ft)||(this.ctx.save(),oi(this,vt)._++,e(this,vt)>16&&h(this,vt,0),this.ctx.lineDashOffset=-e(this,vt),this.ctx.fillStyle="rgba(255,255,255,0.5)",this.ctx.strokeStyle="red",this.ctx.lineWidth=e(this,bt),this.ctx.setLineDash([10,5]),this.ctx.fillRect(this.x,this.y,this.width,this.height),this.ctx.strokeRect(this.x,this.y,this.width,this.height),this.ctx.restore())}}w=new WeakMap,ft=new WeakMap,I=new WeakMap,J=new WeakMap,W=new WeakMap,bt=new WeakMap,wt=new WeakMap,P=new WeakMap,vt=new WeakMap,ie=new WeakMap,ne=new WeakMap,Ie=new WeakSet,xi=function(t){const i=t.deltaY>0?.95:1.05;p(this,oe,Ge).call(this,i)},Ae=new WeakSet,Si=function(){h(this,I,!1)},Pe=new WeakSet,ki=function(t){const{left:i,top:n}=this.ctx.canvas.getBoundingClientRect(),o=t.clientX-i,l=t.clientY-n;if(e(this,J)){const d=t.clientX-e(this,ie),g=t.clientY-e(this,ne);p(this,Be,zi).call(this,d,g)}e(this,W)||p(this,We,Ri).call(this,o,l),li(o,l,this.x,this.y,this.width,this.height,e(this,bt))?(h(this,I,!0),h(this,ft,!1)):h(this,I,!1),h(this,ie,t.clientX),h(this,ne,t.clientY)},Re=new WeakSet,Ei=function(t){if(h(this,ft,!1),t.pointerType==="mouse"&&t.button===0){h(this,J,!0);return}e(this,P).set(t.pointerId,t);const{left:i,top:n}=this.ctx.canvas.getBoundingClientRect();let o=!1;for(let l of e(this,P).values()){const d=l.clientX-i,g=l.clientY-n;if(li(d,g,this.x,this.y,this.width,this.height,e(this,bt))){o=!0;break}}h(this,I,o)},ze=new WeakSet,Li=function(t){if(t.pointerType==="mouse"&&t.button===0){h(this,J,!1),h(this,W,!1);return}p(this,se,$e).call(this,t)},Te=new WeakSet,Ii=function(t){p(this,se,$e).call(this,t)},_e=new WeakSet,Ai=function(t){if(t.pointerType==="mouse"){p(this,Pe,ki).call(this,t);return}const i=Array.from(e(this,P).values());if(i.length===1&&e(this,I)){const n=i[0],{clientX:o,clientY:l}=t,d=e(this,P).get(n.pointerId);if(d){const g=o-d.clientX,c=l-d.clientY;this.x+=g,this.y+=c,e(this,w).x+=g,e(this,w).y+=c,e(this,w).updateRenderPosition()}}if(i.length===2&&e(this,I)){let n=e(this,P).get(i[0].pointerId),o=e(this,P).get(i[1].pointerId);if(n&&o){const l=i[0].pointerId===t.pointerId?i[1]:i[0];let d=p(this,re,Ke).call(this,l,t),g=p(this,re,Ke).call(this,n,o),c=d>g?1.02:.98;p(this,oe,Ge).call(this,c)}}e(this,P).set(t.pointerId,t)},Ce=new WeakSet,Pi=function(t){t.pointerType==="mouse"&&(h(this,J,!1),h(this,W,!1))},se=new WeakSet,$e=function(t){e(this,P).delete(t.pointerId),e(this,P).size||h(this,I,!1)},re=new WeakSet,Ke=function(t,i){const n=Math.abs(t.clientX-i.clientX),o=Math.abs(t.clientY-i.clientY);return Math.pow(n,2)+Math.pow(o,2)},oe=new WeakSet,Ge=function(t){const i=this.width*t-this.width,n=this.height*t-this.height;this.x=this.x-i/2,this.width=this.width+i,this.y=this.y-n/2,this.height=this.height+n,e(this,w).x=this.x,e(this,w).y=this.y,e(this,w).width=this.width,e(this,w).height=this.height,e(this,w).updateRenderPosition()},We=new WeakSet,Ri=function(t,i){const n=nn(t,i,this.x,this.y,this.width,this.height,e(this,bt));n.left||n.right?(this.ctx.canvas.style.cursor="ew-resize",h(this,wt,n.left?"left":"right")):n.top||n.bottom?(this.ctx.canvas.style.cursor="ns-resize",h(this,wt,n.top?"top":"bottom")):e(this,I)?this.ctx.canvas.style.cursor="move":this.ctx.canvas.style.cursor="default"},Be=new WeakSet,zi=function(t,i){switch(this.ctx.canvas.style.cursor){case"move":this.x+=t,this.y+=i,e(this,w).x+=t,e(this,w).y+=i,e(this,w).updateRenderPosition();break;case"ew-resize":{if(h(this,W,!0),e(this,wt)==="right"){const n=Math.max(this.width+t,1);this.width=n,e(this,w).width=n}else{const n=this.x+t;if(n>=this.x+this.width)break;const o=this.width-t;this.x=n,e(this,w).x=n,this.width=o,e(this,w).width=o}e(this,w).updateRenderPosition();break}case"ns-resize":{if(h(this,W,!0),e(this,wt)==="bottom"){const n=Math.max(this.height+i,1);this.height=n,e(this,w).height=n}else{const n=this.y+i;if(n>=this.y+this.height)break;const o=this.height-i;this.y=n,e(this,w).y=n,this.height=o,e(this,w).height=o}e(this,w).updateRenderPosition()}}};const cn="wanted-poster",dn=["name","bounty","name-spacing","bounty-spacing","avatar-url","filter","shadow"];var Q,Z,ae,E,yt,T,C,H,D,jt,he,Nt,Se,le,Je,ce,Qe;class un extends HTMLElement{constructor(){super();a(this,Nt);a(this,le);a(this,ce);a(this,Q,void 0);a(this,Z,void 0);a(this,ae,void 0);a(this,E,void 0);a(this,yt,void 0);a(this,T,void 0);a(this,C,void 0);a(this,H,void 0);a(this,D,void 0);a(this,jt,void 0);a(this,he,void 0);h(this,D,"init");const t=this.attachShadow({mode:"open"}),i=document.createElement("canvas"),n=document.createElement("div");n.className="container",n.appendChild(i);const o=document.createElement("style");o.textContent=rn,t.append(o,n);const l=i.getContext("2d");h(this,Q,n),h(this,Z,i),h(this,ae,l),h(this,H,new pi(l)),h(this,E,new ui(l)),h(this,T,new ci(l)),h(this,C,new gi(l)),h(this,yt,new ln(l,e(this,E))),h(this,jt,new ResizeObserver(()=>{clearTimeout(e(this,he)),h(this,he,window.setTimeout(()=>p(this,le,Je).call(this),200))})),e(this,jt).observe(n)}async export(){var ei,ii,ni,si;const t=document.createElement("canvas");t.style.display="none",e(this,Q).appendChild(t);const i=t.getContext("2d"),n=p(this,Nt,Se).call(this),o=new pi(i),l=new ui(i),d=new ci(i),g=new gi(i);await o.loadImage(ye);const c=ye.width+n*2,u=ye.height+n*2,{wantedImageInfo:f}=o.setSize({width:c,height:u,shadowSize:n});await l.init(f),await d.init(f.namePosition),await g.init(f),await l.loadImage(this.getAttribute("avatar-url")),d.text=(ei=this.getAttribute("name"))!=null?ei:"",g.text=(ii=this.getAttribute("bounty"))!=null?ii:"",d.spacing=parseInt((ni=this.getAttribute("name-spacing"))!=null?ni:"0")||0,g.spacing=parseInt((si=this.getAttribute("bounty-spacing"))!=null?si:"0")||0;const{x:m,y,width:L,height:M,filter:dt}=e(this,E),kt=e(this,H).scale;l.x=m/kt,l.y=y/kt,l.width=L/kt,l.height=M/kt,l.filter=dt,l.updateRenderPosition(),l.render(),o.render(),g.render(),d.render();try{const we=await new Promise(Mi=>{t.toBlob(ji=>Mi(ji),"image/png",1)});if(!we)throw new Error("blob is null");const ri=URL.createObjectURL(we);sn(ri,"wanted-poster.png"),URL.revokeObjectURL(ri),e(this,Q).removeChild(t)}catch(we){console.error(we),this.dispatchEvent(new CustomEvent("ExportError",{bubbles:!0}))}}static get observedAttributes(){return dn}async connectedCallback(){var o,l,d,g;console.log("[connected]"),await new Promise(c=>{setTimeout(()=>c(""))}),h(this,D,"loading");const t=p(this,Nt,Se).call(this),i=e(this,Q).getBoundingClientRect();try{await e(this,H).loadImage(ye);const{wantedImageInfo:c}=e(this,H).setSize({width:i.width,height:i.height,shadowSize:t});await e(this,E).init(c),await e(this,T).init(c.namePosition),await e(this,C).init(c),await e(this,E).loadImage(this.getAttribute("avatar-url"))}catch(c){h(this,D,"error"),console.error("Failed to init wanted poster.",c);return}e(this,T).text=(o=this.getAttribute("name"))!=null?o:"",e(this,C).text=(l=this.getAttribute("bounty"))!=null?l:"",e(this,T).spacing=parseInt((d=this.getAttribute("name-spacing"))!=null?d:"0")||0,e(this,C).spacing=parseInt((g=this.getAttribute("bounty-spacing"))!=null?g:"0")||0;const n=this.getAttribute("filter");n&&(e(this,E).filter=n),h(this,D,"success"),p(this,ce,Qe).call(this),this.dispatchEvent(new CustomEvent("WantedPosterLoaded",{bubbles:!0}))}disconnectedCallback(){console.log("[disconnected]"),e(this,jt).disconnect()}adoptedCallback(){console.log("[adopted]")}async attributeChangedCallback(t,i,n){if(e(this,D)==="success")switch(t){case"name":e(this,T).text=n;break;case"bounty":e(this,C).text=n;break;case"name-spacing":e(this,T).spacing=parseInt(n)||0;break;case"bounty-spacing":e(this,C).spacing=parseInt(n)||0;break;case"avatar-url":{await e(this,E).loadImage(n),e(this,yt).highlight=n!==wi.avatarUrl;break}case"filter":{e(this,E).filter=n;break}case"shadow":{p(this,le,Je).call(this);break}}}}Q=new WeakMap,Z=new WeakMap,ae=new WeakMap,E=new WeakMap,yt=new WeakMap,T=new WeakMap,C=new WeakMap,H=new WeakMap,D=new WeakMap,jt=new WeakMap,he=new WeakMap,Nt=new WeakSet,Se=function(){const t=this.getAttribute("shadow");if(!t)return 0;const i=Number.parseInt(t);return Number.isNaN(i)?0:i},le=new WeakSet,Je=function(){if(e(this,D)!=="success")return;const t=p(this,Nt,Se).call(this),i=e(this,Q).getBoundingClientRect(),n=ti(i.width,i.height,e(this,Z).width,e(this,Z).height),{wantedImageInfo:o}=e(this,H).setSize({width:i.width,height:i.height,shadowSize:t});e(this,T).setPosition(o.namePosition),e(this,C).setPosition(o),e(this,E).setWantedImageInfo(o),e(this,E).scale(n),e(this,yt).scale(n)},ce=new WeakSet,Qe=function(){e(this,ae).clearRect(0,0,e(this,Z).width,e(this,Z).height),e(this,E).render(),e(this,H).render(),e(this,C).render(),e(this,T).render(),e(this,yt).render(),requestAnimationFrame(p(this,ce,Qe).bind(this))};customElements.define(cn,un);const gn=`:host{--text-shadow: .1rem .1rem .1rem rgba(0, 0, 0, .5);--element-filter: drop-shadow(.1rem .2rem .1rem rgba(0, 0, 0, .4)) drop-shadow(-.1rem 0 .1rem rgba(0, 0, 0, .4)) contrast(100%) brightness(100%);--element-hover-filter: drop-shadow(.2rem .3rem .1rem rgba(0, 0, 0, .4)) drop-shadow(-.2rem 0 .1rem rgba(0, 0, 0, .5)) contrast(110%) brightness(110%);--slider-thumb-size: 2rem;display:block;position:fixed;top:0;left:0;width:18.75rem;max-width:80%;height:100%;transform:translate(-105%);transition:transform .2s;box-shadow:.1rem 0 .3rem #00000080;background:linear-gradient(120deg,rgb(245 198 95),rgb(245 218 158),rgb(245 198 96));border:1px solid #3b230e;padding:.125rem;box-sizing:border-box}:host(.open){transform:translate(0)}.container{display:flex;flex-direction:column;width:100%;height:100%;background:url(./images/wood-bg.png) repeat-y center top;background-size:100% auto;border:.0625rem solid rgb(180,150,81);box-shadow:inset 0 0 .2rem .2rem #0000007f;box-sizing:border-box}.field-container{display:flex;flex-direction:column;gap:2rem;flex:1 0;padding:1rem;overflow-y:auto;overflow-x:hidden}.action-container{display:flex;align-items:center;justify-content:space-around;height:4rem;padding:0 1rem}.wood-button{border:0;font-size:1rem;outline:none;color:#fff;cursor:pointer;background-image:url(./images/wood-button.png);background-color:transparent;background-size:100% 100%;background-repeat:no-repeat;background-position:center;width:6rem;height:2rem;display:flex;align-items:center;justify-content:center;color:#fffc;text-shadow:var(--text-shadow);filter:var(--element-filter);transition:.2s}.wood-button:hover{filter:var(--element-hover-filter)}.close-button{border:0;outline:none;cursor:pointer;background-image:url(./images/close-button.png);background-color:transparent;background-size:100% 100%;background-repeat:no-repeat;background-position:center;width:2rem;height:2rem;filter:var(--element-filter);transition:.2s}.close-button:hover{filter:var(--element-hover-filter)}.text-input{border:0;outline:none;color:#584034;background-image:url(./images/input-frame.png);background-color:transparent;background-size:100% 100%;background-repeat:no-repeat;background-position:center;text-align:center;line-height:4rem;font-size:2rem;padding:0 1rem;text-shadow:var(--text-shadow);filter:var(--element-filter)}.text-input::placeholder{color:#0000004d;font-size:2rem;text-shadow:none}.slider{display:flex;flex-direction:column;align-items:center}.slider__label{font-family:sans-serif;color:#584034;font-size:.75rem;background-image:url(./images/scroll-paper.png);background-color:transparent;background-size:100% 100%;background-repeat:no-repeat;background-position:center;width:6rem;height:2rem;display:inline-flex;align-items:center;justify-content:center;padding-bottom:.1rem;box-sizing:border-box;margin:0;position:relative}.slider__label--small{font-size:.45rem}.slider__input{appearance:none;width:100%;height:2.5rem;background:transparent;outline:none}.slider__input::-webkit-slider-runnable-track{height:.75rem;background-color:#584034;border:1px solid rgba(0,0,0,.8);box-shadow:0 0 3px 1px #000c;border-radius:.1rem}.slider__input::-moz-range-track{height:.75rem;background-color:#584034;border:1px solid rgba(0,0,0,.8);box-shadow:0 0 3px 1px #000c;border-radius:.1rem}.slider__input::-webkit-slider-thumb{appearance:none;position:relative;top:-.75rem;width:var(--slider-thumb-size);height:var(--slider-thumb-size);border:0;background:url(./images/slider-thumb.png);background-color:transparent;background-size:cover;background-repeat:no-repeat;background-position:center;cursor:pointer;filter:var(--element-filter)}.slider__input::-moz-range-thumb{position:relative;top:-.75rem;width:var(--slider-thumb-size);height:var(--slider-thumb-size);border:0;background:url(./images/slider-thumb.png);background-color:transparent;background-size:cover;background-repeat:no-repeat;background-position:center;cursor:pointer;filter:var(--element-filter)}::selection{color:#fff;background:rgba(88,64,52,.8);filter:brightness(120%)}::-webkit-scrollbar{width:.2rem}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:#35261f;border-radius:.1rem}::-webkit-scrollbar-corner{background:transparent}
`,pn=`<div class="container">\r
  <div class="field-container">\r
    <input id="nameInput" class="text-input" placeholder="Name" />\r
    <input id="bountyInput" class="text-input" placeholder="Bounty" />\r
\r
    <div class="slider">\r
      <label for="nameSpacingSlider" class="slider__label slider__label--small">Name Text Spacing</label>\r
      <input id="nameSpacingSlider" class="slider__input" type="range" min="0" max="3">\r
    </div>\r
\r
    <div class="slider">\r
      <label for="bountySpacingSlider" class="slider__label slider__label--small">Bounty Text Spacing</label>\r
      <input id="bountySpacingSlider" class="slider__input" type="range" min="0" max="3">\r
    </div>\r
\r
    <div class="slider">\r
      <label for="shadowSlider" class="slider__label">Shadow</label>\r
      <input id="shadowSlider" class="slider__input" type="range" min="0" max="20">\r
    </div>\r
\r
    <div class="slider">\r
      <label for="blurSlider" class="slider__label">Blur</label>\r
      <input id="blurSlider" class="slider__input" type="range" min="0" max="10">\r
    </div>\r
\r
    <div class="slider">\r
      <label for="brightnessSlider" class="slider__label">Brightness</label>\r
      <input id="brightnessSlider" class="slider__input" type="range" min="0" max="200">\r
    </div>\r
\r
    <div class="slider">\r
      <label for="contrastSlider" class="slider__label">Contrast</label>\r
      <input id="contrastSlider" class="slider__input" type="range" min="0" max="200">\r
    </div>\r
\r
    <div class="slider">\r
      <label for="grayscaleSlider" class="slider__label">Grayscale</label>\r
      <input id="grayscaleSlider" class="slider__input" type="range" min="0" max="100">\r
    </div>\r
\r
    <div class="slider">\r
      <label for="hueRotateSlider" class="slider__label">Hue Rotate</label>\r
      <input id="hueRotateSlider" class="slider__input" type="range" min="0" max="360">\r
    </div>\r
\r
    <div class="slider">\r
      <label for="saturateSlider" class="slider__label">Saturate</label>\r
      <input id="saturateSlider" class="slider__input" type="range" min="0" max="200">\r
    </div>\r
\r
    <div class="slider">\r
      <label for="sepiaSlider" class="slider__label">Sepia</label>\r
      <input id="sepiaSlider" class="slider__input" type="range" min="0" max="100">\r
    </div>\r
  </div>\r
  <div class="action-container">\r
    <button id="closeButton" class="close-button" aria-label="Close edit panel button" title="Close"></button>\r
    <button id="resetButton" class="wood-button" aria-label="Reset button"\r
      title="Reset to default settings.">RESET</button>\r
  </div>\r
</div>`,Ft=new Map,Yt={avatarUrl:"",name:"",bounty:"",nameSpacing:0,bountySpacing:1,filter:"",shadow:10,blur:0,brightness:100,contrast:105,grayscale:35,hueRotate:0,saturate:80,sepia:40};function Ze({blur:r,brightness:s,contrast:t,grayscale:i,hueRotate:n,saturate:o,sepia:l}){return`blur(${r}px) brightness(${s}%) contrast(${t}%) grayscale(${i}%) hue-rotate(${n}deg) saturate(${o}%) sepia(${l}%)`}const b=new Proxy({...Yt,filter:Ze(Yt)},{set(r,s,t,i){if(!(s in Yt))return!1;switch(s){case"blur":case"brightness":case"contrast":case"grayscale":case"hueRotate":case"saturate":case"sepia":const n=Ze({...r,[s]:t});if(n===r.filter)break;r.filter=n,setTimeout(()=>{var l;((l=Ft.get("filter"))!=null?l:[]).forEach(d=>d("filter",n,r))})}return setTimeout(()=>{var o;((o=Ft.get(s))!=null?o:[]).forEach(l=>l(s,t,r))}),Reflect.set(r,s,t,i)}});function x(r,s){let t=Ft.get(r);t||(t=[]),t.push(s),Ft.set(r,t)}function k(r,s){let t=Ft.get(r);if(!t)return;const i=t.findIndex(n=>n===s);i>-1&&t.splice(i,1)}function Ti(r={}){Object.assign(b,{...Yt,filter:Ze(Yt),...r})}const mn="edit-panel",_i=document.createElement("template");_i.innerHTML=pn;var Ot,V,tt,et,it,nt,st,rt,ot,at,ht,lt,ct,de,ue,Ut,v;class fn extends HTMLElement{constructor(){super();a(this,Ot,!1);a(this,V,void 0);a(this,tt,void 0);a(this,et,void 0);a(this,it,void 0);a(this,nt,void 0);a(this,st,void 0);a(this,rt,void 0);a(this,ot,void 0);a(this,at,void 0);a(this,ht,void 0);a(this,lt,void 0);a(this,ct,void 0);a(this,de,void 0);a(this,ue,void 0);a(this,Ut,void 0);a(this,v,void 0);const t=this.attachShadow({mode:"open"}),i=document.createElement("style");i.textContent=gn,t.append(i,_i.content.cloneNode(!0)),h(this,V,t.querySelector("#nameInput")),h(this,tt,t.querySelector("#bountyInput")),h(this,et,t.querySelector("#nameSpacingSlider")),h(this,it,t.querySelector("#bountySpacingSlider")),h(this,nt,t.querySelector("#shadowSlider")),h(this,st,t.querySelector("#blurSlider")),h(this,rt,t.querySelector("#brightnessSlider")),h(this,ot,t.querySelector("#contrastSlider")),h(this,at,t.querySelector("#grayscaleSlider")),h(this,ht,t.querySelector("#hueRotateSlider")),h(this,lt,t.querySelector("#saturateSlider")),h(this,ct,t.querySelector("#sepiaSlider")),h(this,de,t.querySelector("#closeButton")),h(this,ue,t.querySelector("#resetButton")),h(this,v,(n,o)=>{switch(o=o.toString(),n){case"name":e(this,V).value=o;break;case"bounty":e(this,tt).value=o;break;case"nameSpacing":e(this,et).value=o;break;case"bountySpacing":e(this,it).value=o;break;case"shadow":e(this,nt).value=o;break;case"blur":e(this,st).value=o;break;case"brightness":e(this,rt).value=o;break;case"contrast":e(this,ot).value=o;break;case"grayscale":e(this,at).value=o;break;case"hueRotate":e(this,ht).value=o;break;case"saturate":e(this,lt).value=o;break;case"sepia":e(this,ct).value=o;break}}),h(this,Ut,n=>{n.target instanceof Node&&this.contains(n.target)||this.toggle(!1)})}toggle(t){if(t){h(this,Ot,!0),this.classList.add("open"),setTimeout(()=>{h(this,Ot,!1)},200);return}!e(this,Ot)&&this.classList.remove("open")}connectedCallback(){window.addEventListener("pointerdown",e(this,Ut)),x("name",e(this,v)),x("bounty",e(this,v)),x("nameSpacing",e(this,v)),x("bountySpacing",e(this,v)),x("shadow",e(this,v)),x("blur",e(this,v)),x("saturate",e(this,v)),x("contrast",e(this,v)),x("grayscale",e(this,v)),x("hueRotate",e(this,v)),x("hueRotate",e(this,v)),x("sepia",e(this,v)),e(this,V).value=b.name,e(this,tt).value=b.bounty.toString(),e(this,et).value=b.nameSpacing.toString(),e(this,it).value=b.bountySpacing.toString(),e(this,nt).value=b.shadow.toString(),e(this,st).value=b.blur.toString(),e(this,rt).value=b.brightness.toString(),e(this,ot).value=b.contrast.toString(),e(this,at).value=b.grayscale.toString(),e(this,ht).value=b.hueRotate.toString(),e(this,lt).value=b.saturate.toString(),e(this,ct).value=b.sepia.toString(),e(this,V).addEventListener("input",()=>b.name=e(this,V).value),e(this,tt).addEventListener("input",()=>b.bounty=e(this,tt).value),e(this,et).addEventListener("input",()=>b.nameSpacing=parseInt(e(this,et).value)),e(this,it).addEventListener("input",()=>b.bountySpacing=parseInt(e(this,it).value)),e(this,nt).addEventListener("input",()=>b.shadow=parseInt(e(this,nt).value)),e(this,st).addEventListener("input",()=>b.blur=parseInt(e(this,st).value)),e(this,rt).addEventListener("input",()=>b.brightness=parseInt(e(this,rt).value)),e(this,ot).addEventListener("input",()=>b.contrast=parseInt(e(this,ot).value)),e(this,at).addEventListener("input",()=>b.grayscale=parseInt(e(this,at).value)),e(this,ht).addEventListener("input",()=>b.hueRotate=parseInt(e(this,ht).value)),e(this,lt).addEventListener("input",()=>b.saturate=parseInt(e(this,lt).value)),e(this,ct).addEventListener("input",()=>b.sepia=parseInt(e(this,ct).value)),e(this,de).addEventListener("click",()=>this.toggle(!1)),e(this,ue).addEventListener("click",()=>Ti())}disconnectedCallback(){window.removeEventListener("pointerdown",e(this,Ut)),k("name",e(this,v)),k("bounty",e(this,v)),k("shadow",e(this,v)),k("blur",e(this,v)),k("saturate",e(this,v)),k("contrast",e(this,v)),k("grayscale",e(this,v)),k("hueRotate",e(this,v)),k("hueRotate",e(this,v)),k("sepia",e(this,v))}}Ot=new WeakMap,V=new WeakMap,tt=new WeakMap,et=new WeakMap,it=new WeakMap,nt=new WeakMap,st=new WeakMap,rt=new WeakMap,ot=new WeakMap,at=new WeakMap,ht=new WeakMap,lt=new WeakMap,ct=new WeakMap,de=new WeakMap,ue=new WeakMap,Ut=new WeakMap,v=new WeakMap;customElements.define(mn,fn);const bn=`:host{display:block;width:100%;height:100%;background-image:url(./images/wood-panel.jpg);background-blend-mode:multiply;background-size:cover;background-position:center;padding:1rem;box-sizing:border-box;transition:background-color .2s}:host(.warcriminal){background-image:url(./images/wood-panel.jpg),url(./images/blood-stains-0.png)}:host(.dragin){background-color:silver}#uploadInput{display:none}.blood-overlay{position:absolute;width:100%;height:100%;top:0;left:0;opacity:.8;display:none;background-image:url(./images/blood-stains-1.png);background-size:cover;background-position:center;mix-blend-mode:multiply;animation-name:fade-in;animation-duration:4s}.blood-overlay--visible{display:block}.loading-overlay{position:absolute;width:100%;height:100%;top:0;left:0;display:flex;align-items:center;justify-content:center;background-image:radial-gradient(#e1e4e7,#a5aab0)}.loading-overlay__luffy{max-width:50vw;max-height:40vh;filter:drop-shadow(0 3px 3px rgba(0,0,0,.5))}.button-container{position:absolute;display:flex;box-sizing:border-box;gap:.5rem;bottom:0;left:0;padding:0 1rem 1rem}.criminal{position:fixed;bottom:1.2rem;right:1rem;outline:none;cursor:pointer;margin-left:auto;width:5rem;height:5rem;border:0;padding:0;background-color:transparent;visibility:hidden;opacity:0;transition:2s}.criminal--visible{visibility:visible;opacity:1}.criminal.criminal--visible:after{top:55%;opacity:1}.criminal:before{position:absolute;top:0;left:0;content:" ";width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center;transition:filter .5s;background-image:url(./images/criminal-avatar.png);filter:contrast(85%) brightness(0%) drop-shadow(1px 1px .5rem crimson) drop-shadow(-1px -1px .5rem crimson)}.criminal--stamp:before{background-image:url(./images/criminal-stamp.png),url(./images/criminal-avatar.png);filter:contrast(85%) brightness(110%) drop-shadow(1px 1px .1rem rgba(0,0,0,.5)) drop-shadow(-1px -1px .1rem rgba(0,0,0,.5))}.criminal:after{position:absolute;top:120%;left:53%;transform:translate(-50%,-50%);color:#fff;content:"?";font-size:2rem;filter:brightness(100%)!important;transition:1s ease-out;opacity:0}.criminal--stamp:after{content:""}@keyframes fade-in{0%{opacity:0}to{opacity:.8}}
`,wn=`<input id="uploadInput" type="file" accept="image/*">\r
<slot name="poster"></slot>\r
<div class="blood-overlay"></div>\r
\r
<div class="button-container">\r
  <wanted-button id="editButton" icon="fa-cog" title="Open the edit panel.">\r
    EDIT\r
  </wanted-button>\r
\r
  <wanted-button id="importButton" icon="fa-upload" title="Import local image to edit.">\r
    IMPORT\r
  </wanted-button>\r
\r
  <wanted-button id="exportButton" icon="fa-download" title="Export as image file.">\r
    EXPORT\r
  </wanted-button>\r
</div>\r
\r
<button id="criminalButton" class="criminal" aria-label="Criminal mode button" title="War criminal"></button>\r
\r
<slot name="editPanel"></slot>\r
<slot></slot>\r
\r
<div class="loading-overlay">\r
  <luffy-logo class="loading-overlay__luffy"></luffy-logo>\r
</div>`,vn="app-container",xe="#warcriminal",Ci=document.createElement("template");Ci.innerHTML=wn;var ge,qt,X,pe,me,xt,St,fe,A,Ht,S,Me,Wi,je,Bi,be,Ve,B,Y;class yn extends HTMLElement{constructor(){super();a(this,Me);a(this,je);a(this,be);a(this,B);a(this,ge,void 0);a(this,qt,void 0);a(this,X,void 0);a(this,pe,void 0);a(this,me,void 0);a(this,xt,void 0);a(this,St,void 0);a(this,fe,0);a(this,A,void 0);a(this,Ht,void 0);a(this,S,void 0);const t=this.attachShadow({mode:"open"});h(this,A,t);const i=document.createElement("style");i.textContent=bn,t.append(i,Ci.content.cloneNode(!0)),t.addEventListener("WantedPosterLoaded",()=>{p(this,Me,Wi).call(this)});const n=e(this,A).querySelector("slot[name=poster]");h(this,qt,n==null?void 0:n.assignedNodes()[0]);const o=e(this,A).querySelector("slot[name=editPanel]");h(this,ge,o==null?void 0:o.assignedNodes()[0]),h(this,X,e(this,A).querySelector("#uploadInput")),h(this,pe,e(this,A).querySelector("#editButton")),h(this,me,e(this,A).querySelector("#importButton")),h(this,xt,e(this,A).querySelector("#exportButton")),h(this,St,e(this,A).querySelector("#criminalButton")),h(this,Ht,p(this,je,Bi).bind(this)),h(this,S,(l,d)=>{switch(l){case"avatarUrl":p(this,B,Y).call(this,{"avatar-url":d.toString()});break;case"nameSpacing":p(this,B,Y).call(this,{"name-spacing":d.toString()});break;case"bountySpacing":p(this,B,Y).call(this,{"bounty-spacing":d.toString()});break;case"name":case"bounty":case"shadow":case"filter":p(this,B,Y).call(this,{[l]:d.toString()})}}),window.addEventListener("hashchange",e(this,Ht))}connectedCallback(){h(this,fe,new Date().getTime()),p(this,B,Y).call(this,{"name-spacing":b.nameSpacing.toString(),"bounty-spacing":b.bountySpacing.toString(),shadow:b.shadow.toString(),filter:b.filter}),x("avatarUrl",e(this,S)),x("name",e(this,S)),x("bounty",e(this,S)),x("nameSpacing",e(this,S)),x("bountySpacing",e(this,S)),x("shadow",e(this,S)),x("filter",e(this,S)),location.hash===xe&&p(this,be,Ve).call(this,!0),this.addEventListener("dragover",t=>{t.preventDefault()}),this.addEventListener("dragenter",()=>{this.classList.add("dragin")}),this.addEventListener("dragleave",()=>{this.classList.remove("dragin")}),this.addEventListener("drop",t=>{var o;t.preventDefault(),this.classList.remove("dragin");const i=(o=t.dataTransfer)==null?void 0:o.files[0];if(!i||!i.type.startsWith("image"))return;const n=URL.createObjectURL(i);p(this,B,Y).call(this,{"avatar-url":n})}),e(this,X).addEventListener("change",()=>{const t=e(this,X).files?e(this,X).files[0]:null;if(!t||!t.type.startsWith("image"))return;const i=URL.createObjectURL(t);p(this,B,Y).call(this,{"avatar-url":i})}),e(this,pe).addEventListener("click",()=>{e(this,ge).toggle(!0)}),e(this,me).addEventListener("click",()=>{e(this,X).value="",e(this,X).click()}),e(this,xt).addEventListener("click",async()=>{e(this,xt).setAttribute("loading","true"),await e(this,qt).export(),e(this,xt).removeAttribute("loading")}),e(this,St).addEventListener("click",()=>{const t=location.hash===xe;location.hash=t?"":xe})}disconnectedCallback(){window.removeEventListener("hashchange",e(this,Ht)),k("avatarUrl",e(this,S)),k("name",e(this,S)),k("bounty",e(this,S)),k("shadow",e(this,S)),k("filter",e(this,S))}}ge=new WeakMap,qt=new WeakMap,X=new WeakMap,pe=new WeakMap,me=new WeakMap,xt=new WeakMap,St=new WeakMap,fe=new WeakMap,A=new WeakMap,Ht=new WeakMap,S=new WeakMap,Me=new WeakSet,Wi=function(){const t=e(this,A).querySelector(".loading-overlay");let i=1e3,n=setInterval(()=>{new Date().getTime()-e(this,fe)<i||(clearTimeout(n),t.style.transition="opacity 1s",t.style.opacity="0",setTimeout(()=>t.remove(),1e3),setTimeout(()=>e(this,St).classList.add("criminal--visible"),1e4))},200)},je=new WeakSet,Bi=function(){p(this,be,Ve).call(this,location.hash===xe)},be=new WeakSet,Ve=function(t){const i=e(this,A).querySelector(".blood-overlay");!i||(this.classList.toggle("warcriminal"),i.classList.toggle("blood-overlay--visible"),e(this,St).classList.toggle("criminal--stamp"),t&&Ti({...wi}))},B=new WeakSet,Y=function(t){var n;const i=Object.keys(t);for(let o of i){const l=(n=t[o])!=null?n:"";e(this,qt).setAttribute(o,l)}};customElements.define(vn,yn);
