var he=Object.defineProperty;var Gt=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var Dt=(h,t,e)=>t in h?he(h,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[t]=e,H=(h,t)=>{for(var e in t||(t={}))ce.call(t,e)&&Dt(h,e,t[e]);if(Gt)for(var e of Gt(t))le.call(t,e)&&Dt(h,e,t[e]);return h};var U=(h,t,e)=>(Dt(h,typeof t!="symbol"?t+"":t,e),e),Ft=(h,t,e)=>{if(!t.has(h))throw TypeError("Cannot "+e)};var i=(h,t,e)=>(Ft(h,t,"read from private field"),e?e.call(h):t.get(h)),o=(h,t,e)=>{if(t.has(h))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(h):t.set(h,e)},a=(h,t,e,s)=>(Ft(h,t,"write to private field"),s?s.call(h,e):t.set(h,e),e),qt=(h,t,e,s)=>({set _(n){a(h,t,n,e)},get _(){return i(h,t,s)}}),g=(h,t,e)=>(Ft(h,t,"access private method"),e);import{v as de,n as ge}from"./vendor.098c5d43.js";const ue=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}};ue();function me(h={}){const{immediate:t=!1,onNeedRefresh:e,onOfflineReady:s,onRegistered:n,onRegisterError:r}=h;let c,l;const f=async(d=!0)=>{d&&(c==null||c.addEventListener("controlling",m=>{m.isUpdate&&window.location.reload()})),l&&l.waiting&&await ge(l.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){c=new de("/service-worker.js",{scope:"/",type:"classic"}),c.addEventListener("activated",d=>{d.isUpdate||s==null||s()});{const d=()=>{e==null||e()};c.addEventListener("waiting",d),c.addEventListener("externalwaiting",d)}c.register({immediate:t}).then(d=>{l=d,n==null||n(d)}).catch(d=>{r==null||r(d)})}return f}me();async function rt(h){return new Promise((t,e)=>{const s=new Image;s.onload=()=>t(s),s.onerror=e,s.src=h})}function Xt(h,t,e,s){const n=h/e,r=t/s;return Math.min(r,n)}function fe(h,t,e,s,n,r,c=0){const l=c/2,f=e-l,d=s-l,m=e+n+l,y=s+r+l,A=h>=f&&h<=m,B=t>=d&&t<=y;return A&&B}function be(h,t,e,s,n,r,c=0){const l=c/2,f=e-l,d=s-l,m=e+n+l,y=s+r+l,A=e+l,B=s+l,ht=e+n-l,ct=s+r-l;return{left:h>=f&&h<=A,right:h>=ht&&h<=m,top:t>=d&&t<=B,bottom:t>=ct&&t<=y}}function oe(h,t){const{actualBoundingBoxAscent:e,actualBoundingBoxDescent:s}=h.measureText(t);return e+s}function pe(h,t){let e=document.createElement("a");e.setAttribute("href",h),e.setAttribute("download",t),e.style.display="none",document.body.appendChild(e),e.click(),e.remove()}var we=`.container{position:relative;width:100%;height:100%;display:flex;align-items:center;justify-content:center;box-sizing:border-box}
`,ye="assets/one-piece-wanted.d3bd87d0.png";const St={url:ye,width:772,height:1154,avatarPosition:{x:74,y:252,width:638,height:484},namePosition:{x:88,y:826,width:585,height:114},bountyPosition:{x:88,y:953,width:586,height:85},bountyFontSize:60,boundaryOffset:{left:10,right:10,top:10,bottom:10},bellySignSize:{width:60,height:84}};class Ut{constructor(t){U(this,"x",0);U(this,"y",0);U(this,"width",0);U(this,"height",0);U(this,"ctx");this.ctx=t}scale(t){this.x=this.x*t,this.y=this.y*t,this.width=this.width*t,this.height=this.height*t}}var ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAALaSURBVDhPNZTdjuw0EIRtt+04mdlfrUCAEELA4Qpxgc79eQ/e/wV2d5LYjt18zi5WZGXi7urq6vLYf7/9bc+1bdt6K61rCKEZKy44H27vaylliZO1ptba9RCx3rspxXmenedVxDhtegSfRIK10lo7WnHSl6s8v1zIjDHOy8QiXgjycYrJsWop+5pNt2p8b+44OkUomPMGCJmtV2M7OTH6y+WS0tK7ybk64g4K9d5Va9nVNKjM85RSdM5yUur+8vJ8/jSjZghsJN9um/z545MPATLELfPVextioBEYqVEwnRVRc7QDNgo376mzrbmU6lSV1CnSQ0wXJ0GNbcdRD9jTSPf0+/r+miF1Ltje3hF3L6XJP19+hgwVjDHWjzTYBh/ExyAJCWOYrtfp8fHxer2DEKA5Z+2KcI4hkWbUMZvbWz+qz7vW2jwnphhdxeXRptiu9J9bq8uS7u7nEO1Q+7OstYjBSEbgicjOKTul9n0njKMz/lBtRDl0ynuliW3LxJHMMM55jHXKM8BVOfzEYv8Ic2RycD4KJeYxbOOGeTyGMc6o9c632speTDcRdiGkaVrmWX77/okJ8xjLGEmTD0lOtbGpQYxWwe1Kc3boxGTxpLXqmuqWczljh3AA/S/Bx06f2DlIZKLRB+xzWdIUvdHmhl+ndHKJIOBK9tGftbzgP+CMQScmEwa6oVyjLHLJX7/+RAGqoRx1h1vPHFBY7eijkdJPrLrvay2VfFKIlx9wwDSndM37IbThZN3Wz4IK5/D2thof8lEHkrEueCseW1iJ8vt39+Jgc/RWMCh60DW3x/uAjNb6Wvrr+9u63hg1lwzNPmwFWfn6xy/4p9Pn0Aer4wR33hTcBxB8KcKX8elMG5rSAk2554fL0/1yt8TLcMSYMOriAd4/hCCb+xXFzzEt08KN4347tUQ4bjLPEJRJnDnsgDNqsMf12Tfko2CcZEpE8e8k85IeHh7+Azww6jnizFt7AAAAAElFTkSuQmCC",G,Pt,q,Q,Lt;class Qt extends Ut{constructor(){super(...arguments);o(this,G,"");o(this,Pt,1);o(this,q,0);o(this,Q,null);o(this,Lt,1.31)}async init(t){try{const e=await rt(ae);a(this,Q,this.ctx.createPattern(e,"repeat"))}catch(e){throw console.error(e),new Error("Failed to init Name.")}this.setPosition(t)}setPosition(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,a(this,q,this.height*i(this,Lt))}set text(t){const e=new Array(i(this,Pt)).join(" ")+" ";a(this,G,Array.from(t).join(e))}render(){this.ctx.save(),this.ctx.textAlign="center",this.ctx.textBaseline="top",this.ctx.fillStyle=i(this,Q)?i(this,Q):"none",this.ctx.font=`900 ${i(this,q)}px 'Gelasio', 'Noto Sans TC', sans-serif`;const t=oe(this.ctx,i(this,G)),e=this.height/t,s=(t-this.height)/2;this.ctx.font=`900 ${Math.floor(i(this,q)*e)}px 'Gelasio', 'Noto Sans TC', sans-serif`,this.ctx.fillText(i(this,G),this.x+this.width/2,this.y+s,this.width),this.ctx.restore()}}G=new WeakMap,Pt=new WeakMap,q=new WeakMap,Q=new WeakMap,Lt=new WeakMap;var xe="assets/paper.16062456.png";const Vt={x:0,y:0,width:0,height:0};var D,z,p,V,E,lt,_,dt,Zt;class _t extends Ut{constructor(){super(...arguments);o(this,dt);o(this,D,void 0);U(this,"filter","grayscale(35%) sepia(40%) saturate(80%) contrast(105%)");o(this,z,new Map);o(this,p,null);o(this,V,null);o(this,E,H({},Vt));o(this,lt,H({},Vt));o(this,_,{left:0,right:0,top:0,bottom:0})}async init(t){a(this,D,t);try{const e=await rt(xe);a(this,V,this.ctx.createPattern(e,"repeat"))}catch(e){throw console.error(e),new Error("Failed to create fill pattern.")}g(this,dt,Zt).call(this)}async loadImage(t){var e;if(!!t)try{a(this,p,await rt(t)),g(this,dt,Zt).call(this),(e=i(this,z).get("imageloaded"))==null||e.forEach(s=>s())}catch(s){throw console.error(s),new Error("Failed to load avatar image.")}}scale(t){super.scale(t),this.updateRenderPosition()}setWantedImageInfo(t){a(this,D,t),a(this,_,H({},t.boundaryOffset)),a(this,E,H({},t.avatarPosition))}updateRenderPosition(){if(!i(this,p))return;const t=Xt(this.width,this.height,i(this,p).width,i(this,p).height),e=i(this,p).width*t,s=i(this,p).height*t,n=this.x+(this.width-e)/2,r=this.y+(this.height-s)/2;a(this,lt,{x:n,y:r,width:e,height:s})}on(t,e){var s;i(this,z).has(t)||i(this,z).set(t,[]),(s=i(this,z).get(t))==null||s.push(e)}off(t,e){const s=i(this,z).get(t);if(!s)return;const n=s.findIndex(r=>r===e);s.splice(n,1)}render(){if(this.ctx.save(),this.ctx.fillStyle=i(this,V)?i(this,V):"none",this.ctx.fillRect(i(this,E).x,i(this,E).y,i(this,E).width,i(this,E).height),!i(this,p)){this.ctx.restore();return}const{x:t,y:e,width:s,height:n}=i(this,lt);this.ctx.filter=this.filter,this.ctx.drawImage(i(this,p),t,e,s,n);const{left:r,right:c,top:l,bottom:f}=i(this,_);t<=r&&this.ctx.clearRect(0,e,r,n),e<=l&&this.ctx.clearRect(t,0,s,l),t+s>this.ctx.canvas.width-c&&this.ctx.clearRect(this.ctx.canvas.width-c,e,c,n),e+n>this.ctx.canvas.height-f&&this.ctx.clearRect(t,this.ctx.canvas.height-f,s,f),this.ctx.canvas.width,this.ctx.restore()}}D=new WeakMap,z=new WeakMap,p=new WeakMap,V=new WeakMap,E=new WeakMap,lt=new WeakMap,_=new WeakMap,dt=new WeakSet,Zt=function(){if(!i(this,D))return;const{avatarPosition:t,boundaryOffset:e}=i(this,D);this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,a(this,_,H({},e)),a(this,E,{x:this.x,y:this.y,width:this.width,height:this.height}),this.updateRenderPosition()};var ve="assets/belly.5c6b32bd.png",C,kt,gt,Z,ut,$,Rt,tt;class $t extends Ut{constructor(t){super(t);o(this,C,"");o(this,kt,1);o(this,gt,0);o(this,Z,null);o(this,ut,void 0);o(this,$,null);o(this,Rt,10);o(this,tt,null);a(this,ut,new Intl.NumberFormat)}async init(t){try{a(this,$,await rt(ve));const e=await rt(ae);a(this,Z,this.ctx.createPattern(e,"repeat"))}catch(e){throw console.error(e),new Error("Failed to init bounty.")}this.setPosition(t)}setPosition(t){const{bountyPosition:e,bountyFontSize:s,bellySignSize:n}=t;this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,a(this,gt,s),a(this,tt,H({},n))}set text(t){const e=new Array(i(this,kt)).join(" ")+" ",s=Number.parseInt(t);if(Number.isNaN(s)){a(this,C,Array.from(t).join(e));return}const n=i(this,ut).format(s)+"-";a(this,C,Array.from(n).join(e))}render(){if(!i(this,$)||!i(this,tt))return;const{width:t,height:e}=i(this,tt);this.ctx.save(),this.ctx.textAlign="center",this.ctx.textBaseline="top",this.ctx.fillStyle=i(this,Z)?i(this,Z):"none",this.ctx.font=`900 ${i(this,gt)}px 'Itim', sans-serif`;const s=this.x+this.width/2,n=t+i(this,Rt),r=oe(this.ctx,i(this,C)),c=(this.height-r)/2,l=s+n/2,f=this.y+c,d=this.width-n;this.ctx.fillText(i(this,C),l,f,d);const m=Math.min(this.ctx.measureText(i(this,C)).width,d),y=s-n/2-m/2;this.ctx.drawImage(i(this,$),y,this.y,t,e),this.ctx.restore()}}C=new WeakMap,kt=new WeakMap,gt=new WeakMap,Z=new WeakMap,ut=new WeakMap,$=new WeakMap,Rt=new WeakMap,tt=new WeakMap;var I,W,mt,w,T,F,K,S,et,zt,Ae;class te{constructor(t){o(this,zt);o(this,I,void 0);o(this,W,void 0);o(this,mt,1);o(this,w,0);o(this,T,0);o(this,F,0);o(this,K,0);o(this,S,null);o(this,et,null);a(this,I,t),a(this,W,t.canvas)}get scale(){return i(this,mt)}async loadImage(t){try{const e=await rt(t.url);a(this,S,e),a(this,F,e.width),a(this,K,e.height),a(this,et,t)}catch(e){throw console.error(e),new Error("Failed to load wanted image.")}}setSize({width:t,height:e,padding:s}){if(!i(this,S))throw new Error("Failed to set size: wanted image is null");a(this,F,t!=null?t:i(this,F)),a(this,K,e!=null?e:i(this,K)),a(this,T,s!=null?s:i(this,T));const n=i(this,S).width+i(this,T)*2,r=i(this,S).height+i(this,T)*2,c=Xt(i(this,F),i(this,K),n,r);return a(this,mt,c),a(this,w,i(this,T)*c),i(this,W).width=n*c,i(this,W).height=r*c,{wantedImageInfo:g(this,zt,Ae).call(this,c,i(this,w)),scale:c,scaledPadding:i(this,w)}}render(){!i(this,S)||(i(this,I).save(),i(this,I).shadowColor="rgba(0, 0, 0, 1)",i(this,I).shadowBlur=i(this,w),i(this,I).drawImage(i(this,S),i(this,w),i(this,w),i(this,W).width-i(this,w)*2,i(this,W).height-i(this,w)*2),i(this,I).restore())}}I=new WeakMap,W=new WeakMap,mt=new WeakMap,w=new WeakMap,T=new WeakMap,F=new WeakMap,K=new WeakMap,S=new WeakMap,et=new WeakMap,zt=new WeakSet,Ae=function(t,e){if(!i(this,et))throw new Error("Failed to calculate wanted image info: WantedImageInfo object is null");const{url:s,width:n,height:r,avatarPosition:c,namePosition:l,bountyPosition:f,bountyFontSize:d,boundaryOffset:m,bellySignSize:y}=i(this,et),A=B=>{const{x:ht,y:ct,width:J,height:Et}=B;return{x:ht*t+e,y:ct*t+e,width:J*t,height:Et*t}};return{url:s,width:n,height:r,avatarPosition:A(c),namePosition:A(l),bountyPosition:A(f),bountyFontSize:d*t,boundaryOffset:{left:m.left*t+e,right:m.right*t+e,top:m.top*t+e,bottom:m.bottom*t+e},bellySignSize:{width:y.width*t,height:y.height*t}}};var u,M,O,x,it,X,Y,ft,bt,Ct,Ie,Wt,Se,Tt,Pe,Mt,Le,Ot,ke,jt,Re;class Ee extends Ut{constructor(t,e){super(t);o(this,Ct);o(this,Wt);o(this,Tt);o(this,Mt);o(this,Ot);o(this,jt);o(this,u,void 0);o(this,M,!1);o(this,O,!1);o(this,x,!1);o(this,it,4);o(this,X,null);o(this,Y,0);o(this,ft,0);o(this,bt,0);a(this,u,e),e.on("imageloaded",()=>this.reset()),t.canvas.addEventListener("mousedown",g(this,Ct,Ie).bind(this)),t.canvas.addEventListener("mouseup",g(this,Wt,Se).bind(this)),t.canvas.addEventListener("mousemove",g(this,Tt,Pe).bind(this)),t.canvas.addEventListener("mouseout",g(this,Mt,Le).bind(this))}reset(){this.x=i(this,u).x,this.y=i(this,u).y,this.width=i(this,u).width,this.height=i(this,u).height,a(this,M,!1),a(this,O,!1),a(this,x,!1)}render(){!i(this,M)&&!i(this,x)||(this.ctx.save(),qt(this,Y)._++,i(this,Y)>16&&a(this,Y,0),this.ctx.lineDashOffset=-i(this,Y),this.ctx.fillStyle="rgba(255,255,255,0.5)",this.ctx.strokeStyle="red",this.ctx.lineWidth=i(this,it),this.ctx.setLineDash([10,5]),this.ctx.fillRect(this.x,this.y,this.width,this.height),this.ctx.strokeRect(this.x,this.y,this.width,this.height),this.ctx.restore())}}u=new WeakMap,M=new WeakMap,O=new WeakMap,x=new WeakMap,it=new WeakMap,X=new WeakMap,Y=new WeakMap,ft=new WeakMap,bt=new WeakMap,Ct=new WeakSet,Ie=function(){a(this,O,!0)},Wt=new WeakSet,Se=function(){a(this,O,!1),a(this,x,!1)},Tt=new WeakSet,Pe=function(t){const{left:e,top:s}=this.ctx.canvas.getBoundingClientRect(),n=t.clientX-e,r=t.clientY-s;if(i(this,O)){const c=t.clientX-i(this,ft),l=t.clientY-i(this,bt);g(this,jt,Re).call(this,c,l)}i(this,x)||g(this,Ot,ke).call(this,n,r),fe(n,r,this.x,this.y,this.width,this.height,i(this,it))?a(this,M,!0):a(this,M,!1),a(this,ft,t.clientX),a(this,bt,t.clientY)},Mt=new WeakSet,Le=function(){a(this,O,!1),a(this,x,!1)},Ot=new WeakSet,ke=function(t,e){const s=be(t,e,this.x,this.y,this.width,this.height,i(this,it));s.left||s.right?(this.ctx.canvas.style.cursor="ew-resize",a(this,X,s.left?"left":"right")):s.top||s.bottom?(this.ctx.canvas.style.cursor="ns-resize",a(this,X,s.top?"top":"bottom")):i(this,M)?this.ctx.canvas.style.cursor="move":this.ctx.canvas.style.cursor="default"},jt=new WeakSet,Re=function(t,e){switch(this.ctx.canvas.style.cursor){case"move":this.x+=t,this.y+=e,i(this,u).x+=t,i(this,u).y+=e,i(this,u).updateRenderPosition();break;case"ew-resize":{if(a(this,x,!0),i(this,X)==="right"){const s=Math.max(this.width+t,1);this.width=s,i(this,u).width=s}else{const s=this.x+t;if(s>=this.x+this.width)break;const n=this.width-t;this.x=s,i(this,u).x=s,this.width=n,i(this,u).width=n}i(this,u).updateRenderPosition();break}case"ns-resize":{if(a(this,x,!0),i(this,X)==="bottom"){const s=Math.max(this.height+e,1);this.height=s,i(this,u).height=s}else{const s=this.y+e;if(s>=this.y+this.height)break;const n=this.height-e;this.y=s,i(this,u).y=s,this.height=n,i(this,u).height=n}i(this,u).updateRenderPosition()}}};const ze=["name","bounty","avatar-url","filter","padding"];var j,N,pt,b,st,P,L,k,R,nt,wt,ot,Kt,yt,ee,xt,ie;class Ce extends HTMLElement{constructor(){super();o(this,ot);o(this,yt);o(this,xt);o(this,j,void 0);o(this,N,void 0);o(this,pt,void 0);o(this,b,void 0);o(this,st,void 0);o(this,P,void 0);o(this,L,void 0);o(this,k,void 0);o(this,R,void 0);o(this,nt,void 0);o(this,wt,void 0);a(this,R,"init");const t=this.attachShadow({mode:"open"}),e=document.createElement("canvas"),s=document.createElement("div");s.className="container",s.appendChild(e);const n=document.createElement("style");n.textContent=we,t.append(n,s);const r=e.getContext("2d");a(this,j,s),a(this,N,e),a(this,pt,r),a(this,k,new te(r)),a(this,b,new _t(r)),a(this,P,new Qt(r)),a(this,L,new $t(r)),a(this,st,new Ee(r,i(this,b))),a(this,nt,new ResizeObserver(()=>{clearTimeout(i(this,wt)),a(this,wt,window.setTimeout(()=>g(this,yt,ee).call(this),200))})),i(this,nt).observe(s)}async export(){var Et,Yt;const t=document.createElement("canvas");t.style.display="none",i(this,j).appendChild(t);const e=t.getContext("2d"),s=g(this,ot,Kt).call(this),n=new te(e),r=new _t(e),c=new Qt(e),l=new $t(e);await n.loadImage(St);const f=St.width+s*2,d=St.height+s*2,{wantedImageInfo:m}=n.setSize({width:f,height:d,padding:s});await r.init(m),await c.init(m.namePosition),await l.init(m),await r.loadImage(this.getAttribute("avatar-url")),c.text=(Et=this.getAttribute("name"))!=null?Et:"",l.text=(Yt=this.getAttribute("bounty"))!=null?Yt:"";const{x:y,y:A,width:B,height:ht,filter:ct}=i(this,b),J=i(this,k).scale;r.x=y/J,r.y=A/J,r.width=B/J,r.height=ht/J,r.filter=ct,r.updateRenderPosition(),r.render(),n.render(),l.render(),c.render();try{t.toBlob(It=>{if(!It)return;const Jt=URL.createObjectURL(It);pe(Jt,"wanted-poster.png"),URL.revokeObjectURL(Jt),i(this,j).removeChild(t)},"image/png",1)}catch(It){console.error(It),this.dispatchEvent(new CustomEvent("ExportError",{bubbles:!0}))}}static get observedAttributes(){return ze}async connectedCallback(){var n,r;console.log("[connected]"),await new Promise(c=>{setTimeout(()=>c(""))}),a(this,R,"loading");const t=g(this,ot,Kt).call(this),e=i(this,j).getBoundingClientRect();try{await i(this,k).loadImage(St);const{wantedImageInfo:c}=i(this,k).setSize({width:e.width,height:e.height,padding:t});await i(this,b).init(c),await i(this,P).init(c.namePosition),await i(this,L).init(c),await i(this,b).loadImage(this.getAttribute("avatar-url"))}catch(c){a(this,R,"error"),console.error("Failed to init wanted poster.",c);return}i(this,P).text=(n=this.getAttribute("name"))!=null?n:"",i(this,L).text=(r=this.getAttribute("bounty"))!=null?r:"";const s=this.getAttribute("filter");s&&(i(this,b).filter=s),a(this,R,"success"),g(this,xt,ie).call(this),this.dispatchEvent(new CustomEvent("WantedPosterLoaded",{bubbles:!0}))}disconnectedCallback(){console.log("[disconnected]"),i(this,nt).disconnect()}adoptedCallback(){console.log("[adopted]")}async attributeChangedCallback(t,e,s){if(i(this,R)==="success")switch(t){case"name":i(this,P).text=s;break;case"bounty":i(this,L).text=s;break;case"avatar-url":{await i(this,b).loadImage(s);break}case"filter":{i(this,b).filter=s;break}case"padding":{g(this,yt,ee).call(this);break}}}}j=new WeakMap,N=new WeakMap,pt=new WeakMap,b=new WeakMap,st=new WeakMap,P=new WeakMap,L=new WeakMap,k=new WeakMap,R=new WeakMap,nt=new WeakMap,wt=new WeakMap,ot=new WeakSet,Kt=function(){const t=this.getAttribute("padding");if(!t)return 0;const e=Number.parseInt(t);return Number.isNaN(e)?0:e},yt=new WeakSet,ee=function(){if(i(this,R)!=="success")return;const t=g(this,ot,Kt).call(this),e=i(this,j).getBoundingClientRect(),s=Xt(e.width,e.height,i(this,N).width,i(this,N).height),{wantedImageInfo:n}=i(this,k).setSize({width:e.width,height:e.height,padding:t});i(this,P).setPosition(n.namePosition),i(this,L).setPosition(n),i(this,b).setWantedImageInfo(n),i(this,b).scale(s),i(this,st).scale(s)},xt=new WeakSet,ie=function(){i(this,pt).clearRect(0,0,i(this,N).width,i(this,N).height),i(this,b).render(),i(this,k).render(),i(this,L).render(),i(this,P).render(),i(this,st).render(),requestAnimationFrame(g(this,xt,ie).bind(this))};customElements.define("wanted-poster",Ce);var We=`.app{width:100%;height:100%;background-image:url(./images/wood-panel.jpg);background-blend-mode:multiply;background-size:cover;background-position:center;padding:1rem;box-sizing:border-box;transition:background-color .2s}.app--warcriminal{background-image:url(./images/wood-panel.jpg),url(./images/blood-stains-0.png)}.app--dragin{background-color:silver}.blood-overlay{position:absolute;width:100%;height:100%;top:0;left:0;opacity:.8;display:none;background-image:url(./images/blood-stains-1.png);background-size:cover;background-position:center;mix-blend-mode:multiply;animation-name:fade-in;animation-duration:4s}.blood-overlay--visible{display:block}.loading-overlay{position:absolute;width:100%;height:100%;top:0;left:0;display:flex;align-items:center;justify-content:center;background-image:radial-gradient(#e1e4e7,#a5aab0)}.loading-overlay__luffy{max-width:50vw;max-height:40vh;animation-name:logo-blink;animation-duration:2s;animation-iteration-count:infinite;animation-timing-function:linear;filter:contrast(80%) brightness(85%) drop-shadow(0 1px 3px gray)}.img-button{cursor:pointer;width:5rem;height:5rem;border:0;padding:0;background-color:transparent;background-size:contain;background-repeat:no-repeat;background-position:center;transition:.5s}.img-button--upload,.img-button--download{position:absolute;bottom:1rem;filter:contrast(100%) brightness(100%) drop-shadow(0 0 5px gray)}.img-button--upload{left:1rem;background-image:url(./images/upload-icon.png)}.img-button--download{left:6rem;background-image:url(./images/download-icon.png)}.img-button--upload:hover,.img-button--download:hover{filter:contrast(110%) brightness(110%) drop-shadow(0 1px 5px black)}.img-button--blood-hand{position:absolute;bottom:0;right:0;margin-right:1rem;margin-bottom:1rem;background-image:url(./images/blood-hand.png);filter:contrast(80%) brightness(85%) drop-shadow(0 0 3px gray);mix-blend-mode:multiply}.img-button--blood-hand:hover{filter:contrast(100%) brightness(100%) drop-shadow(0 0 7px #770707)}@keyframes logo-blink{50%{filter:contrast(120%) brightness(110%) drop-shadow(0 5px 3px gray)}}@keyframes fade-in{0%{opacity:0}to{opacity:.8}}
`;const re=document.createElement("template");re.innerHTML=`
<main class="app">
  <slot name="poster"></slot>
  <div class="blood-overlay"></div>

  <slot></slot>

  <button id="upload" class="img-button img-button--upload"></button>
  <button id="download" class="img-button img-button--download"></button>
  <button id="blood-hand" class="img-button img-button--blood-hand"></button>

  <div class="loading-overlay">
    <img class="loading-overlay__luffy" src="/images/luffy.png"/>
  </div>
</main>
`;const se="#warcriminal",Te={name:"PUTLER",padding:"10",bounty:"??????????","avatar-url":"./images/war-criminal.png"};var vt,v,at,Nt,Oe,Bt,je,Ht,Ne,At,ne;class Me extends HTMLElement{constructor(){super();o(this,Nt);o(this,Bt);o(this,Ht);o(this,At);o(this,vt,0);o(this,v,void 0);o(this,at,void 0);const t=this.attachShadow({mode:"open"});a(this,v,t);const e=document.createElement("style");e.textContent=We,t.append(e,re.content.cloneNode(!0)),t.addEventListener("WantedPosterLoaded",()=>{g(this,Nt,Oe).call(this)}),a(this,at,g(this,Bt,je).bind(this)),window.addEventListener("hashchange",i(this,at))}connectedCallback(){var e;a(this,vt,new Date().getTime());const t=i(this,v).querySelector("main");t.addEventListener("dragover",s=>{s.preventDefault()}),t.addEventListener("dragenter",()=>{t.classList.add("app--dragin")}),t.addEventListener("dragleave",()=>{t.classList.remove("app--dragin")}),t.addEventListener("drop",s=>{var c;s.preventDefault(),t.classList.remove("app--dragin");const n=(c=s.dataTransfer)==null?void 0:c.files[0];if(!n||!n.type.startsWith("image"))return;const r=URL.createObjectURL(n);g(this,At,ne).call(this,{"avatar-url":r})}),(e=i(this,v).querySelector("button#blood-hand"))==null||e.addEventListener("click",()=>{location.href=se})}disconnectedCallback(){window.removeEventListener("hashchange",i(this,at))}adoptedCallback(){}}vt=new WeakMap,v=new WeakMap,at=new WeakMap,Nt=new WeakSet,Oe=function(){const t=i(this,v).querySelector(".loading-overlay");let e=1,s=setInterval(()=>{new Date().getTime()-i(this,vt)<e||(clearTimeout(s),t.style.transition="opacity 1s",t.style.opacity="0",setTimeout(()=>{t.remove()},1e3))},200)},Bt=new WeakSet,je=function(){g(this,Ht,Ne).call(this,location.hash===se)},Ht=new WeakSet,Ne=function(t){const e=i(this,v).querySelector(".app"),s=i(this,v).querySelector(".blood-overlay");if(!(!e||!s)){if(!t){e.classList.remove("app--warcriminal"),s.classList.remove("blood-overlay--visible");return}e.classList.add("app--warcriminal"),s.classList.add("blood-overlay--visible"),g(this,At,ne).call(this,Te)}},At=new WeakSet,ne=function(t){var r;const e=i(this,v).querySelector("slot[name=poster]"),s=e==null?void 0:e.assignedNodes()[0],n=Object.keys(t);for(let c of n){const l=(r=t[c])!=null?r:"";s.setAttribute(c,l)}};customElements.define("app-container",Me);
